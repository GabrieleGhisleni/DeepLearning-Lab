I"­ð<p>Principal Component and Cluster Analys</p>

<hr />

<blockquote>
  <h3 id="--load-the-data-and-perform-a-pca-produce-a-plot-of-the-variance-explained-by-the-first-componentsand-a-scree-plot">- Load the data and perform a PCA. Produce a plot of the variance explained by the first components,and a scree plot.</h3>
</blockquote>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="s2">"gene_expr.tsv"</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="o">=</span><span class="s2">"\t"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>We start performing the PCA taking care to scale the data, since this
methods is very sensitive to that.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="s2">"FactoMineR"</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="s2">"factoextra"</span><span class="p">)</span><span class="w">

</span><span class="n">data_string</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="p">[,</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">]</span><span class="w">
</span><span class="n">data_numeric</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="p">[,</span><span class="m">-1</span><span class="o">:</span><span class="m">-2</span><span class="p">]</span><span class="w">
</span><span class="n">data_string</span><span class="o">$</span><span class="n">subtype</span><span class="w"> </span><span class="o">&lt;-</span><span class="n">as.factor</span><span class="p">(</span><span class="n">data_string</span><span class="o">$</span><span class="n">subtype</span><span class="p">)</span><span class="w">
</span><span class="n">first_PCA</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">PCA</span><span class="p">(</span><span class="n">data_numeric</span><span class="p">,</span><span class="w"> </span><span class="n">scale.unit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">graph</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>Letâ€™s explore the result of the PCA:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">pander</span><span class="p">)</span><span class="w">
</span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="w">
</span><span class="n">tmp_</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">first_PCA</span><span class="o">$</span><span class="n">eig</span><span class="p">[</span><span class="m">0</span><span class="o">:</span><span class="n">n</span><span class="p">,</span><span class="m">3</span><span class="p">])</span><span class="w">
</span><span class="n">colnames</span><span class="p">(</span><span class="n">tmp_</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Cumulative Variance Explained"</span><span class="p">)</span><span class="w">
</span><span class="n">pander</span><span class="p">(</span><span class="n">tmp_</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Â </th>
      <th style="text-align: center">Cumulative Variance Explained</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><strong>comp 1</strong></td>
      <td style="text-align: center">18.11</td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>comp 2</strong></td>
      <td style="text-align: center">28.9</td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>comp 3</strong></td>
      <td style="text-align: center">34.99</td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>comp 4</strong></td>
      <td style="text-align: center">39.56</td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>comp 5</strong></td>
      <td style="text-align: center">43.15</td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>comp 6</strong></td>
      <td style="text-align: center">46.21</td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>comp 7</strong></td>
      <td style="text-align: center">48.78</td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>comp 8</strong></td>
      <td style="text-align: center">50.94</td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>comp 9</strong></td>
      <td style="text-align: center">52.99</td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>comp 10</strong></td>
      <td style="text-align: center">54.94</td>
    </tr>
  </tbody>
</table>

<p>We can see that the first ten components explain almost the 55% of the
variance inside our data. We can also graphically see the importance of
those:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">ggthemes</span><span class="p">)</span><span class="w">
</span><span class="n">fviz_eig</span><span class="p">(</span><span class="n">first_PCA</span><span class="p">,</span><span class="w"> </span><span class="n">addlabels</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">100</span><span class="p">),</span><span class="w">
         </span><span class="n">barfill</span><span class="o">=</span><span class="s2">"steelblue"</span><span class="p">,</span><span class="w"> </span><span class="n">barcolor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"steelblue"</span><span class="p">,</span><span class="w">
         </span><span class="n">ncp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">ggtheme</span><span class="o">=</span><span class="w"> </span><span class="n">theme_tufte</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/clustering/README-unnamed-chunk-5-1.png" alt="" /><!-- --></p>

<p>From this plot we can see that there are 2 important components which
contribute with almost 30% of the variance. If we look at the â€˜elbowâ€™ in
the screeplot we can capture only the 30%, the rest 70% is distributed
over all the other dimensions.</p>

<blockquote>
  <h3 id="--make-a-few-scatterplots-of-the-first-principal-component-score-vectors-plot-the-observations-according-to-the-given-subtypes-and-assess-to-what-extent-the-subtypes-are-similar-to-each-other-and-are-captured-by-the-pca">- Make a few scatterplots of the first principal component score vectors. Plot the observations according to the given subtypes and assess to what extent the subtypes are similar to each other and are captured by the PCA.</h3>
</blockquote>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">gridExtra</span><span class="p">)</span><span class="w">
</span><span class="n">sc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">first_PCA</span><span class="o">$</span><span class="n">ind</span><span class="o">$</span><span class="n">coord</span><span class="p">)</span><span class="w">
</span><span class="n">sc</span><span class="o">$</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"B"</span><span class="w"> 
</span><span class="n">sc</span><span class="o">$</span><span class="n">color</span><span class="p">[(</span><span class="n">nrow</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span><span class="o">/</span><span class="m">2</span><span class="p">)</span><span class="o">:</span><span class="n">nrow</span><span class="p">(</span><span class="n">sc</span><span class="p">)]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"T"</span><span class="w"> 

</span><span class="n">g1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">sc</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Dim.1</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">Dim.2</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="o">=</span><span class="n">color</span><span class="p">))</span><span class="o">+</span><span class="w">
      </span><span class="n">geom_point</span><span class="p">()</span><span class="o">+</span><span class="w"> </span><span class="n">theme_tufte</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Dim 2 ~ Dim 1"</span><span class="p">)</span><span class="o">+</span><span class="w">
      </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="o">=</span><span class="s2">"top"</span><span class="p">)</span><span class="o">+</span><span class="w"> 
      </span><span class="n">scale_colour_manual</span><span class="p">(</span><span class="s2">"Group"</span><span class="p">,</span><span class="w"> </span><span class="n">values</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"royalblue"</span><span class="p">,</span><span class="s2">"firebrick"</span><span class="p">))</span><span class="w">

</span><span class="n">g2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">sc</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Dim.1</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">Dim.3</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="o">=</span><span class="n">color</span><span class="p">))</span><span class="o">+</span><span class="w">
      </span><span class="n">geom_point</span><span class="p">()</span><span class="o">+</span><span class="w"> </span><span class="n">theme_tufte</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Dim 3 ~ Dim 1"</span><span class="p">)</span><span class="o">+</span><span class="w">
      </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="o">=</span><span class="s2">"top"</span><span class="p">)</span><span class="o">+</span><span class="w"> 
      </span><span class="n">scale_colour_manual</span><span class="p">(</span><span class="s2">"Group"</span><span class="p">,</span><span class="w"> </span><span class="n">values</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"royalblue"</span><span class="p">,</span><span class="s2">"firebrick"</span><span class="p">))</span><span class="w">

</span><span class="n">g3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">sc</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Dim.2</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">Dim.3</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="o">=</span><span class="n">color</span><span class="p">))</span><span class="o">+</span><span class="w">
      </span><span class="n">geom_point</span><span class="p">()</span><span class="o">+</span><span class="w"> </span><span class="n">theme_tufte</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Dim 2 ~ Dim 3"</span><span class="p">)</span><span class="o">+</span><span class="w">
      </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="o">=</span><span class="s2">"top"</span><span class="p">)</span><span class="o">+</span><span class="w"> 
      </span><span class="n">scale_colour_manual</span><span class="p">(</span><span class="s2">"Group"</span><span class="p">,</span><span class="w"> </span><span class="n">values</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"royalblue"</span><span class="p">,</span><span class="s2">"firebrick"</span><span class="p">))</span><span class="w">

</span><span class="n">grid.arrange</span><span class="p">(</span><span class="n">g1</span><span class="p">,</span><span class="n">g2</span><span class="p">,</span><span class="n">g3</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="o">=</span><span class="m">3</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/clustering/README-unnamed-chunk-6-1.png" alt="" /><!-- --></p>

<p>We can see that the points are not very well separated.</p>

<blockquote>
  <h3 id="--hierarchically-cluster-the-patients-using-complete-linkage-and-euclidean-distance-as-dissimilarity-measure-cut-the-dendrogram-so-as-to-have-two-groups-evaluate-the-goodness-of-the-clustering-by-comparing-the-groups-with-the-given-subtypes-provide-a-numerical-similarity-measure">- Hierarchically cluster the patients using complete linkage and Euclidean distance as dissimilarity measure. Cut the dendrogram so as to have two groups. Evaluate the goodness of the clustering by comparing the groups with the given subtypes. Provide a numerical similarity measure.</h3>
</blockquote>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scale_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scale</span><span class="p">(</span><span class="n">data_numeric</span><span class="p">)</span><span class="w">
</span><span class="n">dist_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dist</span><span class="p">(</span><span class="n">scale_data</span><span class="p">)</span><span class="w"> </span><span class="c1">#Euclidean distance is default.</span><span class="w">
</span><span class="n">truth</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data_string</span><span class="o">$</span><span class="n">subtype</span><span class="w">
</span><span class="n">hierarchical_cluster_complete</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hclust</span><span class="p">(</span><span class="n">dist_df</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"complete"</span><span class="p">)</span><span class="w"> 
</span><span class="n">hierarchical_cluster_complete</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## 
## Call:
## hclust(d = dist_df, method = "complete")
## 
## Cluster method   : complete 
## Distance         : euclidean 
## Number of objects: 128
</code></pre></div></div>

<p>letâ€™s also plot this dendogram:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fviz_dend</span><span class="p">(</span><span class="n">hierarchical_cluster_complete</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="s2">"Complete linkage with euclidean distance"</span><span class="p">,</span><span class="w"> 
          </span><span class="n">k</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">palette</span><span class="o">=</span><span class="w"> </span><span class="s2">"ucscgb"</span><span class="p">,</span><span class="w"> </span><span class="n">show_labels</span><span class="o">=</span><span class="nb">F</span><span class="p">,</span><span class="w"> </span><span class="n">ggtheme</span><span class="o">=</span><span class="w"> </span><span class="n">ggthemes</span><span class="o">::</span><span class="n">theme_tufte</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/clustering/README-unnamed-chunk-8-1.png" alt="" /><!-- --> We can also have a
numerical representation of the goodness of the model with the ARI.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">mclust</span><span class="p">)</span><span class="w">

</span><span class="n">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span><span class="w">
</span><span class="n">cutted</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cutree</span><span class="p">(</span><span class="n">hierarchical_cluster_complete</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">ARI_hierarchical_cluster_complete</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">adjustedRandIndex</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span><span class="n">cutted</span><span class="p">)</span><span class="c1">#is correct?</span><span class="w">
</span><span class="c1">#I was thinking if i use:</span><span class="w">
</span><span class="c1">#max(ifelse(cutted==1,"B","T"), ifelse(cutted==1,"T","B")) is logical wrong?</span><span class="w">
</span><span class="n">print</span><span class="p">(</span><span class="n">ARI_hierarchical_cluster_complete</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] 0.02266644
</code></pre></div></div>

<p>In this case is very low, so it is not a good cluster analysis. We will
try different linkage or distances then we will try different operation
in order to have better results.</p>

<blockquote>
  <h3 id="--see-if-you-can-improve-the-results-for-example-repeat-the-procedure-using-correlation-as-dissimilarity-measure-and-with-single-or-average-linkage-discuss-the-results-and-pick-the-combination-of-dissimilarity-measure-and-linkage-method-that-works-best">- See if you can improve the results. For example, repeat the procedure using correlation as dissimilarity measure, and with single or average linkage. Discuss the results and pick the combination of dissimilarity measure and linkage method that works best.</h3>
</blockquote>

<p>We start by all the other method but with the same euclidean distance,
then we will move to the correlation distance, L1 norm and Lâˆž and we
will also try different linkages!</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">h_cluster_eu_average</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hclust</span><span class="p">((</span><span class="n">dist_df</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"average"</span><span class="p">)</span><span class="w">
</span><span class="n">fviz_dend</span><span class="p">(</span><span class="n">h_cluster_eu_average</span><span class="p">,</span><span class="w"> 
          </span><span class="n">main</span><span class="o">=</span><span class="s2">"Average linkage with euclidean based distance"</span><span class="p">,</span><span class="w"> 
          </span><span class="n">k</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">palette</span><span class="o">=</span><span class="w"> </span><span class="s2">"ucscgb"</span><span class="p">,</span><span class="w"> </span><span class="n">show_labels</span><span class="o">=</span><span class="nb">F</span><span class="p">,</span><span class="w"> </span><span class="n">ggtheme</span><span class="o">=</span><span class="w"> </span><span class="n">ggthemes</span><span class="o">::</span><span class="n">theme_tufte</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/clustering/README-unnamed-chunk-10-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span><span class="w">
</span><span class="n">cutted</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cutree</span><span class="p">(</span><span class="n">h_cluster_eu_average</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">ARI_h_cluster_eu_average</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">adjustedRandIndex</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span><span class="n">cutted</span><span class="p">)</span><span class="w">
</span><span class="n">print</span><span class="p">(</span><span class="n">ARI_h_cluster_eu_average</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] -0.0101038
</code></pre></div></div>

<p>None of the method based on euclidean distance perform properly, the ARI
is near or under 0. Letâ€™s try with correlation distance instead:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">corr_distance</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.dist</span><span class="p">(</span><span class="m">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">cor</span><span class="p">((</span><span class="n">t</span><span class="p">(</span><span class="n">scale_data</span><span class="p">))))</span><span class="w">
</span><span class="n">h_cluster_corr_average</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hclust</span><span class="p">((</span><span class="n">corr_distance</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"average"</span><span class="p">)</span><span class="w">
</span><span class="n">fviz_dend</span><span class="p">(</span><span class="n">h_cluster_corr_average</span><span class="p">,</span><span class="w"> 
          </span><span class="n">main</span><span class="o">=</span><span class="s2">"Average linkage with correlation based distance"</span><span class="p">,</span><span class="w"> 
          </span><span class="n">k</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">palette</span><span class="o">=</span><span class="w"> </span><span class="s2">"lancet"</span><span class="p">,</span><span class="w"> </span><span class="n">show_labels</span><span class="o">=</span><span class="nb">F</span><span class="p">,</span><span class="w">  </span><span class="n">ggtheme</span><span class="o">=</span><span class="w"> </span><span class="n">ggthemes</span><span class="o">::</span><span class="n">theme_tufte</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/clustering/README-unnamed-chunk-12-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span><span class="w">
</span><span class="n">cutted</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cutree</span><span class="p">(</span><span class="n">h_cluster_corr_average</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">ARI_h_cluster_corr_average</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">adjustedRandIndex</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span><span class="n">cutted</span><span class="p">)</span><span class="w">
</span><span class="n">print</span><span class="p">(</span><span class="n">ARI_h_cluster_corr_average</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] 0.03457948
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">h_cluster_corr_complete</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hclust</span><span class="p">((</span><span class="n">corr_distance</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"complete"</span><span class="p">)</span><span class="w">
</span><span class="n">fviz_dend</span><span class="p">(</span><span class="n">h_cluster_corr_complete</span><span class="p">,</span><span class="w"> 
          </span><span class="n">main</span><span class="o">=</span><span class="s2">"Complete linkage with correlation based distance"</span><span class="p">,</span><span class="w"> 
          </span><span class="n">k</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">palette</span><span class="o">=</span><span class="w"> </span><span class="s2">"lancet"</span><span class="p">,</span><span class="w"> </span><span class="n">show_labels</span><span class="o">=</span><span class="nb">F</span><span class="p">,</span><span class="w">  </span><span class="n">ggtheme</span><span class="o">=</span><span class="w"> </span><span class="n">ggthemes</span><span class="o">::</span><span class="n">theme_tufte</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/clustering/README-unnamed-chunk-14-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span><span class="w">
</span><span class="n">cutted</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cutree</span><span class="p">(</span><span class="n">h_cluster_corr_complete</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">ARI_h_cluster_corr_complete</span><span class="o">&lt;-</span><span class="w"> </span><span class="n">adjustedRandIndex</span><span class="p">(</span><span class="n">cutted</span><span class="p">,</span><span class="w"> </span><span class="n">truth</span><span class="p">)</span><span class="w">
</span><span class="n">print</span><span class="p">(</span><span class="n">ARI_h_cluster_corr_complete</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] 0.002309898
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">h_cluster_corr_single</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hclust</span><span class="p">((</span><span class="n">corr_distance</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"single"</span><span class="p">)</span><span class="w">
</span><span class="n">fviz_dend</span><span class="p">(</span><span class="n">h_cluster_corr_single</span><span class="p">,</span><span class="w"> 
          </span><span class="n">main</span><span class="o">=</span><span class="s2">"Single linkage with correlation based distance"</span><span class="p">,</span><span class="w"> 
          </span><span class="n">k</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">palette</span><span class="o">=</span><span class="w"> </span><span class="s2">"lancet"</span><span class="p">,</span><span class="w"> </span><span class="n">show_labels</span><span class="o">=</span><span class="nb">F</span><span class="p">,</span><span class="w"> </span><span class="n">ggtheme</span><span class="o">=</span><span class="w"> </span><span class="n">ggthemes</span><span class="o">::</span><span class="n">theme_tufte</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/clustering/README-unnamed-chunk-16-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span><span class="w">
</span><span class="n">cutted</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cutree</span><span class="p">(</span><span class="n">h_cluster_corr_single</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">ARI_h_cluster_corr_single</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">adjustedRandIndex</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span><span class="n">cutted</span><span class="p">)</span><span class="w">
</span><span class="n">print</span><span class="p">(</span><span class="n">ARI_h_cluster_corr_single</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] -0.0101038
</code></pre></div></div>

<p>None of the graph above gave good results. Letâ€™s try with L1 norm
distance:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">graphics</span><span class="p">)</span><span class="w">
</span><span class="n">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span><span class="w">
</span><span class="n">l1_dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dist</span><span class="p">((</span><span class="n">scale_data</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"manhattan"</span><span class="p">)</span><span class="w"> </span><span class="c1"># L1_NORM</span><span class="w">
</span><span class="n">h_cluster_l1_average</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hclust</span><span class="p">((</span><span class="n">l1_dist</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"average"</span><span class="p">)</span><span class="w">
</span><span class="n">fviz_dend</span><span class="p">(</span><span class="n">h_cluster_l1_average</span><span class="p">,</span><span class="w"> 
          </span><span class="n">main</span><span class="o">=</span><span class="s2">"Average linkage with L1 based distance"</span><span class="p">,</span><span class="w"> 
          </span><span class="n">k</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">palette</span><span class="o">=</span><span class="w"> </span><span class="s2">"simpsons"</span><span class="p">,</span><span class="w"> </span><span class="n">show_labels</span><span class="o">=</span><span class="nb">F</span><span class="p">,</span><span class="w"> </span><span class="n">ggtheme</span><span class="o">=</span><span class="w"> </span><span class="n">ggthemes</span><span class="o">::</span><span class="n">theme_tufte</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/clustering/README-unnamed-chunk-18-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cutted</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cutree</span><span class="p">(</span><span class="n">h_cluster_l1_average</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">ARI_h_cluster_l1_average</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">adjustedRandIndex</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span><span class="n">cutted</span><span class="p">)</span><span class="w">
</span><span class="n">print</span><span class="p">(</span><span class="n">ARI_h_cluster_l1_average</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] 0.05067021
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span><span class="w">
</span><span class="n">h_cluster_l1_complete</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hclust</span><span class="p">((</span><span class="n">l1_dist</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"complete"</span><span class="p">)</span><span class="w">
</span><span class="n">fviz_dend</span><span class="p">(</span><span class="n">h_cluster_l1_complete</span><span class="p">,</span><span class="w"> 
          </span><span class="n">main</span><span class="o">=</span><span class="s2">"Complete linkage with L1 based distance"</span><span class="p">,</span><span class="w"> 
          </span><span class="n">k</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">palette</span><span class="o">=</span><span class="w"> </span><span class="s2">"simpsons"</span><span class="p">,</span><span class="w"> </span><span class="n">show_labels</span><span class="o">=</span><span class="nb">F</span><span class="p">,</span><span class="w"> </span><span class="n">ggtheme</span><span class="o">=</span><span class="w"> </span><span class="n">ggthemes</span><span class="o">::</span><span class="n">theme_tufte</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/clustering/README-unnamed-chunk-20-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cutted</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cutree</span><span class="p">(</span><span class="n">h_cluster_l1_complete</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">ARI_h_cluster_l1_complete</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">adjustedRandIndex</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span><span class="n">cutted</span><span class="p">)</span><span class="w">
</span><span class="n">print</span><span class="p">(</span><span class="n">ARI_h_cluster_l1_complete</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] -0.06349051
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">graphics</span><span class="p">)</span><span class="w">
</span><span class="n">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span><span class="w">
</span><span class="n">max_dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dist</span><span class="p">((</span><span class="n">scale_data</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"max"</span><span class="p">)</span><span class="w"> </span><span class="c1"># MAX</span><span class="w">
</span><span class="n">h_cluster_max_average</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hclust</span><span class="p">((</span><span class="n">max_dist</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"average"</span><span class="p">)</span><span class="w">
</span><span class="n">fviz_dend</span><span class="p">(</span><span class="n">h_cluster_max_average</span><span class="p">,</span><span class="w"> 
          </span><span class="n">main</span><span class="o">=</span><span class="s2">"Average linkage with max based distance"</span><span class="p">,</span><span class="w"> 
          </span><span class="n">k</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">palette</span><span class="o">=</span><span class="w"> </span><span class="s2">"d3"</span><span class="p">,</span><span class="w"> </span><span class="n">show_labels</span><span class="o">=</span><span class="nb">F</span><span class="p">,</span><span class="w"> </span><span class="n">ggtheme</span><span class="o">=</span><span class="w"> </span><span class="n">ggthemes</span><span class="o">::</span><span class="n">theme_tufte</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/clustering/README-unnamed-chunk-22-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cutted</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cutree</span><span class="p">(</span><span class="n">h_cluster_max_average</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">ARI_h_cluster_max_average</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">adjustedRandIndex</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span><span class="n">cutted</span><span class="p">)</span><span class="w">
</span><span class="n">print</span><span class="p">(</span><span class="n">ARI_h_cluster_max_average</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] -0.0101038
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span><span class="w">
</span><span class="n">h_cluster_max_complete</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hclust</span><span class="p">((</span><span class="n">max_dist</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"complete"</span><span class="p">)</span><span class="w">
</span><span class="n">fviz_dend</span><span class="p">(</span><span class="n">h_cluster_max_complete</span><span class="p">,</span><span class="w"> 
          </span><span class="n">main</span><span class="o">=</span><span class="s2">"Complete linkage with max based distance"</span><span class="p">,</span><span class="w"> 
          </span><span class="n">k</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">palette</span><span class="o">=</span><span class="w"> </span><span class="s2">"d3"</span><span class="p">,</span><span class="w"> </span><span class="n">show_labels</span><span class="o">=</span><span class="nb">F</span><span class="p">,</span><span class="w"> </span><span class="n">ggtheme</span><span class="o">=</span><span class="w"> </span><span class="n">ggthemes</span><span class="o">::</span><span class="n">theme_tufte</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/clustering/README-unnamed-chunk-24-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cutted</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cutree</span><span class="p">(</span><span class="n">h_cluster_max_complete</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">ARI_h_cluster_max_complete</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">adjustedRandIndex</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span><span class="n">cutted</span><span class="p">)</span><span class="w">
</span><span class="n">print</span><span class="p">(</span><span class="n">ARI_h_cluster_max_complete</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] 0.1278833
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">results_first</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">Value</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">ARI_h_cluster_eu_average</span><span class="p">,</span><span class="w">
                                    </span><span class="n">ARI_h_cluster_corr_single</span><span class="p">,</span><span class="w">
                                    </span><span class="n">ARI_h_cluster_corr_average</span><span class="p">,</span><span class="w">
                                   </span><span class="n">ARI_hierarchical_cluster_complete</span><span class="p">,</span><span class="w">
                                   </span><span class="n">ARI_h_cluster_corr_complete</span><span class="p">,</span><span class="w">
                                   </span><span class="n">ARI_h_cluster_l1_complete</span><span class="p">,</span><span class="w">
                                   </span><span class="n">ARI_h_cluster_l1_average</span><span class="p">,</span><span class="w">
                                   </span><span class="n">ARI_h_cluster_max_average</span><span class="p">,</span><span class="w">
                                   </span><span class="n">ARI_h_cluster_max_complete</span><span class="p">),</span><span class="w">
                            </span><span class="n">Names</span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Average Euclidean"</span><span class="p">,</span><span class="s2">"Single correlation"</span><span class="p">,</span><span class="w"> 
                                     </span><span class="s2">"Average correlation"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Complete Euclidean"</span><span class="p">,</span><span class="w">
                                     </span><span class="s2">"Complete correlation"</span><span class="p">,</span><span class="w">
                                     </span><span class="s2">"Complete L1"</span><span class="p">,</span><span class="w">
                                     </span><span class="s2">"Average L1"</span><span class="p">,</span><span class="w">
                                     </span><span class="s2">"Average Max"</span><span class="p">,</span><span class="w">
                                     </span><span class="s2">"Complete Max"</span><span class="p">))</span><span class="w">

</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">results_first</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">reorder</span><span class="p">(</span><span class="n">Names</span><span class="p">,</span><span class="w"> </span><span class="o">+</span><span class="n">Value</span><span class="p">),</span><span class="w"> </span><span class="n">x</span><span class="o">=</span><span class="n">Value</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="n">Names</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span><span class="o">=</span><span class="s2">"identity"</span><span class="p">)</span><span class="o">+</span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Ari ~ Methods"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">theme_tufte</span><span class="p">()</span><span class="o">+</span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"none"</span><span class="p">)</span><span class="o">+</span><span class="n">ylab</span><span class="p">(</span><span class="s2">"Method"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/clustering/README-unnamed-chunk-26-1.png" alt="" /><!-- --></p>

<p>From this first results we can see that none of our cluster analysis is
performing well.</p>

<blockquote>
  <h3 id="from-the-full-dataset-select-the-top-n-eg-n--200-genes-that-differ-the-most-across-all-samples-based-on-pca-repeat-the-hierarchical-clustering-cut-the-dendrogram-to-have-two-groups-evaluate-the-results">From the full dataset select the top N (e.g., N = 200) genes that differ the most across all samples, based on PCA; repeat the hierarchical clustering; cut the dendrogram to have two groups; evaluate the results.</h3>
</blockquote>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">total_genes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">prcomp</span><span class="p">(</span><span class="n">data_numeric</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="nb">T</span><span class="p">)</span><span class="w">
</span><span class="n">loadings</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">apply</span><span class="p">(</span><span class="n">total_genes</span><span class="o">$</span><span class="n">rotation</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">sum</span><span class="p">)</span><span class="w">
</span><span class="n">index</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">order</span><span class="p">(</span><span class="nf">abs</span><span class="p">(</span><span class="n">loadings</span><span class="p">),</span><span class="w"> </span><span class="n">decreasing</span><span class="o">=</span><span class="nb">T</span><span class="p">)</span><span class="w">
</span><span class="n">reduced_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data_numeric</span><span class="p">[,</span><span class="n">index</span><span class="p">[</span><span class="m">0</span><span class="o">:</span><span class="m">200</span><span class="p">]]</span><span class="w">
</span><span class="n">pander</span><span class="p">(</span><span class="n">reduced_df</span><span class="p">[</span><span class="m">0</span><span class="o">:</span><span class="m">3</span><span class="p">,</span><span class="m">0</span><span class="o">:</span><span class="m">5</span><span class="p">])</span><span class="w"> </span><span class="c1"># first 5 columns</span><span class="w">
</span></code></pre></div></div>

<table>
  <thead>
    <tr>
      <th style="text-align: center">X35644_at</th>
      <th style="text-align: center">X40428_i_at</th>
      <th style="text-align: center">X38671_at</th>
      <th style="text-align: center">X36432_at</th>
      <th style="text-align: center">X1586_at</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">3.163</td>
      <td style="text-align: center">5.264</td>
      <td style="text-align: center">8.896</td>
      <td style="text-align: center">3.873</td>
      <td style="text-align: center">4.514</td>
    </tr>
    <tr>
      <td style="text-align: center">3.105</td>
      <td style="text-align: center">5.603</td>
      <td style="text-align: center">7.361</td>
      <td style="text-align: center">3.967</td>
      <td style="text-align: center">4.355</td>
    </tr>
    <tr>
      <td style="text-align: center">3.174</td>
      <td style="text-align: center">6.63</td>
      <td style="text-align: center">10.12</td>
      <td style="text-align: center">3.326</td>
      <td style="text-align: center">4.331</td>
    </tr>
  </tbody>
</table>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scale_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scale</span><span class="p">(</span><span class="n">reduced_df</span><span class="p">)</span><span class="w">
</span><span class="n">dist_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dist</span><span class="p">(</span><span class="n">scale_data</span><span class="p">)</span><span class="w"> 
</span><span class="n">corr_distance</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.dist</span><span class="p">(</span><span class="m">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">cor</span><span class="p">(</span><span class="n">t</span><span class="p">(</span><span class="n">scale_data</span><span class="p">)))</span><span class="w">

</span><span class="n">hierarchical_cluster_complete_reduced</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hclust</span><span class="p">(</span><span class="n">dist_df</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"complete"</span><span class="p">)</span><span class="w"> 
</span><span class="n">hierarchical_cluster_complete_reduced</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## 
## Call:
## hclust(d = dist_df, method = "complete")
## 
## Cluster method   : complete 
## Distance         : euclidean 
## Number of objects: 128
</code></pre></div></div>

<p>letâ€™s also plot this dendogram:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fviz_dend</span><span class="p">(</span><span class="n">hierarchical_cluster_complete_reduced</span><span class="p">,</span><span class="w"> 
          </span><span class="n">main</span><span class="o">=</span><span class="s2">"Complete linkage with euclidean distance"</span><span class="p">,</span><span class="w"> 
          </span><span class="n">k</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">palette</span><span class="o">=</span><span class="w"> </span><span class="s2">"ucscgb"</span><span class="p">,</span><span class="w"> </span><span class="n">show_labels</span><span class="o">=</span><span class="nb">F</span><span class="p">,</span><span class="w"> </span><span class="n">ggtheme</span><span class="o">=</span><span class="w"> </span><span class="n">ggthemes</span><span class="o">::</span><span class="n">theme_tufte</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/clustering/README-unnamed-chunk-29-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span><span class="w">
</span><span class="n">cutted</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cutree</span><span class="p">(</span><span class="n">hierarchical_cluster_complete_reduced</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">ARI_h_complete_reduced</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">adjustedRandIndex</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span><span class="n">cutted</span><span class="p">)</span><span class="w">
</span><span class="n">ARI_h_complete_reduced</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] 0.02471391
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">hierarchical_cluster_average_eu_reduced</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hclust</span><span class="p">(</span><span class="n">dist_df</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"average"</span><span class="p">)</span><span class="w"> 
</span><span class="n">fviz_dend</span><span class="p">(</span><span class="n">hierarchical_cluster_average_eu_reduced</span><span class="p">,</span><span class="w"> 
          </span><span class="n">main</span><span class="o">=</span><span class="s2">"Average linkage with euclidean distance"</span><span class="p">,</span><span class="w"> 
          </span><span class="n">k</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">palette</span><span class="o">=</span><span class="w"> </span><span class="s2">"ucscgb"</span><span class="p">,</span><span class="w"> </span><span class="n">show_labels</span><span class="o">=</span><span class="nb">F</span><span class="p">,</span><span class="w"> </span><span class="n">ggtheme</span><span class="o">=</span><span class="w"> </span><span class="n">ggthemes</span><span class="o">::</span><span class="n">theme_tufte</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/clustering/README-unnamed-chunk-31-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span><span class="w">
</span><span class="n">cutted</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cutree</span><span class="p">(</span><span class="n">hierarchical_cluster_average_eu_reduced</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">ARI_h_avg_reduced</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">adjustedRandIndex</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span><span class="n">cutted</span><span class="p">)</span><span class="w">
</span><span class="n">ARI_h_avg_reduced</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] -0.0101038
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">h_cluster_corr_complete_reduced</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hclust</span><span class="p">((</span><span class="n">corr_distance</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"complete"</span><span class="p">)</span><span class="w">
</span><span class="n">fviz_dend</span><span class="p">(</span><span class="n">h_cluster_corr_complete_reduced</span><span class="p">,</span><span class="w"> 
          </span><span class="n">main</span><span class="o">=</span><span class="s2">"Complete linkage with correlation based distance"</span><span class="p">,</span><span class="w"> 
          </span><span class="n">k</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">palette</span><span class="o">=</span><span class="w"> </span><span class="s2">"lancet"</span><span class="p">,</span><span class="w"> </span><span class="n">show_labels</span><span class="o">=</span><span class="nb">F</span><span class="p">,</span><span class="w">  </span><span class="n">ggtheme</span><span class="o">=</span><span class="w"> </span><span class="n">ggthemes</span><span class="o">::</span><span class="n">theme_tufte</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/clustering/README-unnamed-chunk-33-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span><span class="w">
</span><span class="n">cutted</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cutree</span><span class="p">(</span><span class="n">h_cluster_corr_complete_reduced</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">ARI_h_corr_complete_reduced</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">adjustedRandIndex</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span><span class="n">cutted</span><span class="p">)</span><span class="w">
</span><span class="n">ARI_h_corr_complete_reduced</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] 0.005940882
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">h_cluster_corr_average_reduced</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hclust</span><span class="p">((</span><span class="n">corr_distance</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"average"</span><span class="p">)</span><span class="w">
</span><span class="n">h_cluster_corr_average_reduced</span><span class="o">$</span><span class="n">labels</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data_string</span><span class="o">$</span><span class="n">subtype</span><span class="w">
</span><span class="n">fviz_dend</span><span class="p">(</span><span class="n">h_cluster_corr_average_reduced</span><span class="p">,</span><span class="w"> 
          </span><span class="n">main</span><span class="o">=</span><span class="s2">"Average linkage with correlation based distance"</span><span class="p">,</span><span class="w"> 
          </span><span class="n">k</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">palette</span><span class="o">=</span><span class="w"> </span><span class="s2">"lancet"</span><span class="p">,</span><span class="w"> </span><span class="n">show_labels</span><span class="o">=</span><span class="nb">F</span><span class="p">,</span><span class="w">  </span><span class="n">ggtheme</span><span class="o">=</span><span class="w"> </span><span class="n">ggthemes</span><span class="o">::</span><span class="n">theme_tufte</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/clustering/README-unnamed-chunk-35-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span><span class="w">
</span><span class="n">truth</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data_string</span><span class="o">$</span><span class="n">subtype</span><span class="w">
</span><span class="n">cutted</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cutree</span><span class="p">(</span><span class="n">h_cluster_corr_average_reduced</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">ARI_h_average_reduced</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">adjustedRandIndex</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span><span class="n">cutted</span><span class="p">)</span><span class="w">
</span><span class="n">ARI_h_average_reduced</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] -0.03280954
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span><span class="w">
</span><span class="n">l1_dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dist</span><span class="p">((</span><span class="n">scale_data</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"manhattan"</span><span class="p">)</span><span class="w"> 
</span><span class="n">h_cluster_l1_average</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hclust</span><span class="p">((</span><span class="n">l1_dist</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"average"</span><span class="p">)</span><span class="w">
</span><span class="n">fviz_dend</span><span class="p">(</span><span class="n">h_cluster_l1_average</span><span class="p">,</span><span class="w"> 
          </span><span class="n">main</span><span class="o">=</span><span class="s2">"Average linkage with L1 based distance"</span><span class="p">,</span><span class="w"> 
          </span><span class="n">k</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">palette</span><span class="o">=</span><span class="w"> </span><span class="s2">"simpsons"</span><span class="p">,</span><span class="w"> </span><span class="n">show_labels</span><span class="o">=</span><span class="nb">F</span><span class="p">,</span><span class="w"> </span><span class="n">ggtheme</span><span class="o">=</span><span class="w"> </span><span class="n">ggthemes</span><span class="o">::</span><span class="n">theme_tufte</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/clustering/README-unnamed-chunk-37-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cutted</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cutree</span><span class="p">(</span><span class="n">h_cluster_l1_average</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">ARI_h_cluster_l1_average_2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">adjustedRandIndex</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span><span class="n">cutted</span><span class="p">)</span><span class="w">
</span><span class="n">print</span><span class="p">(</span><span class="n">ARI_h_cluster_l1_average_2</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] -0.0101038
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span><span class="w">
</span><span class="n">h_cluster_l1_complete</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hclust</span><span class="p">((</span><span class="n">l1_dist</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"complete"</span><span class="p">)</span><span class="w">
</span><span class="n">fviz_dend</span><span class="p">(</span><span class="n">h_cluster_l1_complete</span><span class="p">,</span><span class="w"> 
          </span><span class="n">main</span><span class="o">=</span><span class="s2">"Complete linkage with L1 based distance"</span><span class="p">,</span><span class="w"> 
          </span><span class="n">k</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">palette</span><span class="o">=</span><span class="w"> </span><span class="s2">"simpsons"</span><span class="p">,</span><span class="w"> </span><span class="n">show_labels</span><span class="o">=</span><span class="nb">F</span><span class="p">,</span><span class="w"> </span><span class="n">ggtheme</span><span class="o">=</span><span class="w"> </span><span class="n">ggthemes</span><span class="o">::</span><span class="n">theme_tufte</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/clustering/README-unnamed-chunk-39-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cutted</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cutree</span><span class="p">(</span><span class="n">h_cluster_l1_complete</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">ARI_h_cluster_l1_complete_2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">adjustedRandIndex</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span><span class="n">cutted</span><span class="p">)</span><span class="w">
</span><span class="n">print</span><span class="p">(</span><span class="n">ARI_h_cluster_l1_complete_2</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] -0.03651606
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">graphics</span><span class="p">)</span><span class="w">
</span><span class="n">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span><span class="w">
</span><span class="n">max_dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dist</span><span class="p">((</span><span class="n">scale_data</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"max"</span><span class="p">)</span><span class="w"> </span><span class="c1"># MAX</span><span class="w">
</span><span class="n">h_cluster_max_average</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hclust</span><span class="p">((</span><span class="n">max_dist</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"average"</span><span class="p">)</span><span class="w">
</span><span class="n">fviz_dend</span><span class="p">(</span><span class="n">h_cluster_max_average</span><span class="p">,</span><span class="w"> 
          </span><span class="n">main</span><span class="o">=</span><span class="s2">"Average linkage with max based distance"</span><span class="p">,</span><span class="w"> 
          </span><span class="n">k</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">palette</span><span class="o">=</span><span class="w"> </span><span class="s2">"d3"</span><span class="p">,</span><span class="w"> </span><span class="n">show_labels</span><span class="o">=</span><span class="nb">F</span><span class="p">,</span><span class="w"> </span><span class="n">ggtheme</span><span class="o">=</span><span class="w"> </span><span class="n">ggthemes</span><span class="o">::</span><span class="n">theme_tufte</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/clustering/README-unnamed-chunk-41-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cutted</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cutree</span><span class="p">(</span><span class="n">h_cluster_max_average</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">ARI_h_cluster_max_average_2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">adjustedRandIndex</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span><span class="n">cutted</span><span class="p">)</span><span class="w">
</span><span class="n">print</span><span class="p">(</span><span class="n">ARI_h_cluster_max_average_2</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] -0.0101038
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span><span class="w">
</span><span class="n">h_cluster_max_complete</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hclust</span><span class="p">((</span><span class="n">max_dist</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"complete"</span><span class="p">)</span><span class="w">
</span><span class="n">fviz_dend</span><span class="p">(</span><span class="n">h_cluster_max_complete</span><span class="p">,</span><span class="w"> 
          </span><span class="n">main</span><span class="o">=</span><span class="s2">"Complete linkage with max based distance"</span><span class="p">,</span><span class="w"> 
          </span><span class="n">k</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">palette</span><span class="o">=</span><span class="w"> </span><span class="s2">"d3"</span><span class="p">,</span><span class="w"> </span><span class="n">show_labels</span><span class="o">=</span><span class="nb">F</span><span class="p">,</span><span class="w"> </span><span class="n">ggtheme</span><span class="o">=</span><span class="w"> </span><span class="n">ggthemes</span><span class="o">::</span><span class="n">theme_tufte</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/clustering/README-unnamed-chunk-43-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cutted</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cutree</span><span class="p">(</span><span class="n">h_cluster_max_complete</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">ARI_h_cluster_max_complete_2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">adjustedRandIndex</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span><span class="n">cutted</span><span class="p">)</span><span class="w">
</span><span class="n">print</span><span class="p">(</span><span class="n">ARI_h_cluster_max_complete_2</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] -0.0195435
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">results_second</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">Value</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">ARI_h_avg_reduced</span><span class="p">,</span><span class="w">
                                     </span><span class="n">ARI_h_complete_reduced</span><span class="w">
                                    </span><span class="p">,</span><span class="n">ARI_h_cluster_corr_complete</span><span class="p">,</span><span class="w">
                                    </span><span class="n">ARI_h_corr_complete_reduced</span><span class="p">,</span><span class="w">
                                    </span><span class="n">ARI_h_cluster_l1_average_2</span><span class="p">,</span><span class="w">
                                    </span><span class="n">ARI_h_cluster_l1_complete_2</span><span class="p">,</span><span class="w">
                                    </span><span class="n">ARI_h_cluster_max_average_2</span><span class="p">,</span><span class="w">
                                    </span><span class="n">ARI_h_cluster_max_complete_2</span><span class="p">),</span><span class="w">
                            </span><span class="n">Names</span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Average euclidean_2"</span><span class="p">,</span><span class="w"> 
                                     </span><span class="s2">"Complete euclidean_2"</span><span class="p">,</span><span class="w">
                                     </span><span class="s2">"Average correlation_2"</span><span class="p">,</span><span class="w">
                                     </span><span class="s2">"Complete correlation_2"</span><span class="p">,</span><span class="w">
                                     </span><span class="s2">"Complete L1_2"</span><span class="p">,</span><span class="w">
                                     </span><span class="s2">"Average L1_2"</span><span class="p">,</span><span class="w">
                                     </span><span class="s2">"Average Max_2"</span><span class="p">,</span><span class="w">
                                     </span><span class="s2">"Complete Max_2"</span><span class="p">))</span><span class="w">

</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">results_second</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">reorder</span><span class="p">(</span><span class="n">Names</span><span class="p">,</span><span class="w"> </span><span class="o">+</span><span class="n">Value</span><span class="p">),</span><span class="w"> </span><span class="n">x</span><span class="o">=</span><span class="n">Value</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="n">Names</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span><span class="o">=</span><span class="s2">"identity"</span><span class="p">)</span><span class="o">+</span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Ari ~ Methods"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">theme_tufte</span><span class="p">()</span><span class="o">+</span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"none"</span><span class="p">)</span><span class="o">+</span><span class="n">ylab</span><span class="p">(</span><span class="s2">"Method"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/clustering/README-unnamed-chunk-45-1.png" alt="" /><!-- --></p>

<p>The results are not improved yet. letâ€™s try with this last selection!</p>

<blockquote>
  <h3 id="a-different-approach-that-is-popular-in-gene-expression-analysis-is-to-keep-only-the-most-variable-genes-for-downstream-analysis-since-most-of-the-10k-genes-have-low-expression-or-do-not-vary-much-across-the-experiments-this-step-usually-minimizes-the-contribution-of-noise-an-unsupervised-technique-would-then-aim-to-identify-what-explains-this-variance-start-again-from-the-full-dataset-and-keep-only-genes-whose-standard-deviation-is-among-the-top-5-perform-pca-and-produce-a-scatterplot-of-the-first-two-principal-components-scores-coloring-observations-by-subtype-repeat-the-clustering-cutting-evaluation-procedure-what-do-you-observe-and-what-conclusions-do-you-make">A different approach that is popular in gene expression analysis is to keep only the most variable genes for downstream analysis. Since most of the 10K genes have low expression or do not vary much across the experiments, this step usually minimizes the contribution of noise. An unsupervised technique would then aim to identify what explains this variance. Start again from the full dataset and keep only genes whose standard deviation is among the top 5%; perform PCA and produce a scatterplot of the first two principal components scores, coloring observations by subtype; repeat the clustering/ cutting/ evaluation procedure. What do you observe and what conclusions do you make?</h3>
</blockquote>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">vector</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">()</span><span class="w">
</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">data_numeric</span><span class="p">)){</span><span class="w">
   </span><span class="n">vector</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sd</span><span class="p">(</span><span class="n">data_numeric</span><span class="p">[,</span><span class="n">i</span><span class="p">])}</span><span class="w">

</span><span class="n">vector_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">gene_sd</span><span class="o">=</span><span class="n">vector</span><span class="p">,</span><span class="w"> </span><span class="n">col_id</span><span class="o">=</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">vector</span><span class="p">)))</span><span class="w">
</span><span class="n">vector_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">vector_df</span><span class="p">[</span><span class="n">order</span><span class="p">(</span><span class="n">vector_df</span><span class="o">$</span><span class="n">gene_sd</span><span class="p">,</span><span class="n">decreasing</span><span class="o">=</span><span class="nb">T</span><span class="p">),]</span><span class="w">
</span><span class="n">columns_reduced_id</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">vector_df</span><span class="p">[</span><span class="m">0</span><span class="o">:</span><span class="p">(</span><span class="n">nrow</span><span class="p">(</span><span class="n">vector_df</span><span class="p">)</span><span class="o">*</span><span class="m">5</span><span class="o">/</span><span class="m">100</span><span class="p">),</span><span class="m">2</span><span class="p">]</span><span class="w">
</span><span class="n">top_var_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="n">data_numeric</span><span class="p">[,</span><span class="n">columns_reduced_id</span><span class="p">]</span><span class="w">
</span><span class="n">top_var_label</span><span class="w"> </span><span class="o">&lt;-</span><span class="n">data_numeric</span><span class="p">[</span><span class="m">2</span><span class="p">,</span><span class="n">columns_reduced_id</span><span class="p">]</span><span class="w">
</span><span class="n">second_PCA</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">PCA</span><span class="p">(</span><span class="n">top_var_df</span><span class="p">,</span><span class="w"> </span><span class="n">scale.unit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">graph</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span><span class="n">fviz_eig</span><span class="p">(</span><span class="n">second_PCA</span><span class="p">,</span><span class="w"> </span><span class="n">addlabels</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">100</span><span class="p">),</span><span class="w">
         </span><span class="n">barfill</span><span class="o">=</span><span class="s2">"steelblue"</span><span class="p">,</span><span class="w"> </span><span class="n">barcolor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"steelblue"</span><span class="p">,</span><span class="w">
         </span><span class="n">ncp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">ggtheme</span><span class="o">=</span><span class="w"> </span><span class="n">theme_tufte</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/clustering/README-unnamed-chunk-46-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">second_PCA</span><span class="o">$</span><span class="n">ind</span><span class="o">$</span><span class="n">coord</span><span class="p">)</span><span class="w">
</span><span class="n">sc</span><span class="o">$</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"B"</span><span class="w">
</span><span class="n">sc</span><span class="o">$</span><span class="n">color</span><span class="p">[(</span><span class="n">nrow</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span><span class="o">/</span><span class="m">2</span><span class="p">)</span><span class="o">:</span><span class="n">nrow</span><span class="p">(</span><span class="n">sc</span><span class="p">)]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"T"</span><span class="w"> 

</span><span class="n">g1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">sc</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Dim.1</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">Dim.2</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="o">=</span><span class="n">color</span><span class="p">))</span><span class="o">+</span><span class="w">
      </span><span class="n">geom_point</span><span class="p">()</span><span class="o">+</span><span class="w"> </span><span class="n">theme_tufte</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Dim 2 ~ Dim 1"</span><span class="p">)</span><span class="o">+</span><span class="w">
      </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="o">=</span><span class="s2">"top"</span><span class="p">)</span><span class="o">+</span><span class="w"> 
      </span><span class="n">scale_colour_manual</span><span class="p">(</span><span class="s2">"Group"</span><span class="p">,</span><span class="w"> </span><span class="n">values</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"royalblue"</span><span class="p">,</span><span class="s2">"firebrick"</span><span class="p">))</span><span class="w">

</span><span class="n">g2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">sc</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Dim.1</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">Dim.3</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="o">=</span><span class="n">color</span><span class="p">))</span><span class="o">+</span><span class="w">
      </span><span class="n">geom_point</span><span class="p">()</span><span class="o">+</span><span class="w"> </span><span class="n">theme_tufte</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Dim 3 ~ Dim 1"</span><span class="p">)</span><span class="o">+</span><span class="w">
      </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="o">=</span><span class="s2">"top"</span><span class="p">)</span><span class="o">+</span><span class="w"> 
      </span><span class="n">scale_colour_manual</span><span class="p">(</span><span class="s2">"Group"</span><span class="p">,</span><span class="w"> </span><span class="n">values</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"royalblue"</span><span class="p">,</span><span class="s2">"firebrick"</span><span class="p">))</span><span class="w">

</span><span class="n">g3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">sc</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Dim.2</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">Dim.3</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="o">=</span><span class="n">color</span><span class="p">))</span><span class="o">+</span><span class="w">
      </span><span class="n">geom_point</span><span class="p">()</span><span class="o">+</span><span class="w"> </span><span class="n">theme_tufte</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Dim 2 ~ Dim 3"</span><span class="p">)</span><span class="o">+</span><span class="w">
      </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="o">=</span><span class="s2">"top"</span><span class="p">)</span><span class="o">+</span><span class="w"> 
      </span><span class="n">scale_colour_manual</span><span class="p">(</span><span class="s2">"Group"</span><span class="p">,</span><span class="w"> </span><span class="n">values</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"royalblue"</span><span class="p">,</span><span class="s2">"firebrick"</span><span class="p">))</span><span class="w">

</span><span class="n">grid.arrange</span><span class="p">(</span><span class="n">g1</span><span class="p">,</span><span class="n">g2</span><span class="p">,</span><span class="n">g3</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="o">=</span><span class="m">3</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/clustering/README-unnamed-chunk-47-1.png" alt="" /><!-- --></p>

<p>From here we can see that this operation improved the results, the
dimension seems better divided!</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">scale_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scale</span><span class="p">(</span><span class="n">top_var_df</span><span class="p">)</span><span class="w">
</span><span class="n">corr_distance</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.dist</span><span class="p">(</span><span class="m">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">cor</span><span class="p">(</span><span class="n">t</span><span class="p">(</span><span class="n">as.matrix</span><span class="p">(</span><span class="n">scale_data</span><span class="p">)))</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">dist_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dist</span><span class="p">(</span><span class="n">scale_data</span><span class="p">)</span><span class="w"> 

</span><span class="n">hierarchical_cluster_complete_reduced_3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hclust</span><span class="p">(</span><span class="n">dist_df</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"complete"</span><span class="p">)</span><span class="w"> 
</span><span class="n">hierarchical_cluster_complete_reduced_3</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## 
## Call:
## hclust(d = dist_df, method = "complete")
## 
## Cluster method   : complete 
## Distance         : euclidean 
## Number of objects: 128
</code></pre></div></div>

<p>letâ€™s also plot this dendogram:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fviz_dend</span><span class="p">(</span><span class="n">hierarchical_cluster_complete_reduced</span><span class="p">,</span><span class="w"> 
          </span><span class="n">main</span><span class="o">=</span><span class="s2">"Complete linkage with euclidean distance"</span><span class="p">,</span><span class="w"> 
          </span><span class="n">k</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">palette</span><span class="o">=</span><span class="w"> </span><span class="s2">"ucscgb"</span><span class="p">,</span><span class="w"> </span><span class="n">show_labels</span><span class="o">=</span><span class="nb">F</span><span class="p">,</span><span class="w"> </span><span class="n">ggtheme</span><span class="o">=</span><span class="w"> </span><span class="n">ggthemes</span><span class="o">::</span><span class="n">theme_tufte</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/clustering/README-unnamed-chunk-49-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span><span class="w">
</span><span class="n">cutted</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cutree</span><span class="p">(</span><span class="n">hierarchical_cluster_complete_reduced_3</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">ARI_h_complete_reduced_3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">adjustedRandIndex</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span><span class="n">cutted</span><span class="p">)</span><span class="w">
</span><span class="n">ARI_h_complete_reduced_3</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] 1
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">hierarchical_cluster_average_eu_reduced_3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hclust</span><span class="p">(</span><span class="n">dist_df</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"average"</span><span class="p">)</span><span class="w"> 
</span><span class="n">fviz_dend</span><span class="p">(</span><span class="n">hierarchical_cluster_average_eu_reduced_3</span><span class="p">,</span><span class="w"> 
          </span><span class="n">main</span><span class="o">=</span><span class="s2">"Average linkage with euclidean distance"</span><span class="p">,</span><span class="w"> 
          </span><span class="n">k</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">palette</span><span class="o">=</span><span class="w"> </span><span class="s2">"ucscgb"</span><span class="p">,</span><span class="w"> </span><span class="n">show_labels</span><span class="o">=</span><span class="nb">F</span><span class="p">,</span><span class="w"> </span><span class="n">ggtheme</span><span class="o">=</span><span class="w"> </span><span class="n">ggthemes</span><span class="o">::</span><span class="n">theme_tufte</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/clustering/README-unnamed-chunk-51-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span><span class="w">
</span><span class="n">cutted</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cutree</span><span class="p">(</span><span class="n">hierarchical_cluster_average_eu_reduced_3</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">ARI_h_avg_reduced_3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">adjustedRandIndex</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span><span class="n">cutted</span><span class="p">)</span><span class="w">
</span><span class="n">ARI_h_avg_reduced_3</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] 1
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">h_cluster_corr_complete_reduced_3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hclust</span><span class="p">((</span><span class="n">corr_distance</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"complete"</span><span class="p">)</span><span class="w">
</span><span class="n">fviz_dend</span><span class="p">(</span><span class="n">h_cluster_corr_complete_reduced_3</span><span class="p">,</span><span class="w"> 
          </span><span class="n">main</span><span class="o">=</span><span class="s2">"Complete linkage with correlation based distance"</span><span class="p">,</span><span class="w"> 
          </span><span class="n">k</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">palette</span><span class="o">=</span><span class="w"> </span><span class="s2">"lancet"</span><span class="p">,</span><span class="w"> </span><span class="n">show_labels</span><span class="o">=</span><span class="nb">F</span><span class="p">,</span><span class="w">  </span><span class="n">ggtheme</span><span class="o">=</span><span class="w"> </span><span class="n">ggthemes</span><span class="o">::</span><span class="n">theme_tufte</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/clustering/README-unnamed-chunk-53-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span><span class="w">
</span><span class="n">cutted</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cutree</span><span class="p">(</span><span class="n">h_cluster_corr_complete_reduced_3</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">ARI_h_corr_complete_reduced_3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">adjustedRandIndex</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span><span class="n">cutted</span><span class="p">)</span><span class="w">
</span><span class="n">ARI_h_corr_complete_reduced_3</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] 1
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">h_cluster_corr_average_reduced_3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hclust</span><span class="p">((</span><span class="n">corr_distance</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"average"</span><span class="p">)</span><span class="w">
</span><span class="n">fviz_dend</span><span class="p">(</span><span class="n">h_cluster_corr_average_reduced_3</span><span class="p">,</span><span class="w"> 
          </span><span class="n">main</span><span class="o">=</span><span class="s2">"Average linkage with correlation based distance"</span><span class="p">,</span><span class="w"> 
          </span><span class="n">k</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">palette</span><span class="o">=</span><span class="w"> </span><span class="s2">"lancet"</span><span class="p">,</span><span class="w"> </span><span class="n">show_labels</span><span class="o">=</span><span class="nb">F</span><span class="p">,</span><span class="w">  </span><span class="n">ggtheme</span><span class="o">=</span><span class="w"> </span><span class="n">ggthemes</span><span class="o">::</span><span class="n">theme_tufte</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/clustering/README-unnamed-chunk-55-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span><span class="w">
</span><span class="n">cutted</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cutree</span><span class="p">(</span><span class="n">h_cluster_corr_average_reduced_3</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">ARI_h_average_reduced_3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">adjustedRandIndex</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span><span class="n">cutted</span><span class="p">)</span><span class="w">
</span><span class="n">ARI_h_average_reduced_3</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] 1
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span><span class="w">
</span><span class="n">l1_dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dist</span><span class="p">((</span><span class="n">scale_data</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"manhattan"</span><span class="p">)</span><span class="w"> 
</span><span class="n">h_cluster_l1_average</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hclust</span><span class="p">((</span><span class="n">l1_dist</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"average"</span><span class="p">)</span><span class="w">
</span><span class="n">fviz_dend</span><span class="p">(</span><span class="n">h_cluster_l1_average</span><span class="p">,</span><span class="w"> 
          </span><span class="n">main</span><span class="o">=</span><span class="s2">"Average linkage with L1 based distance"</span><span class="p">,</span><span class="w"> 
          </span><span class="n">k</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">palette</span><span class="o">=</span><span class="w"> </span><span class="s2">"simpsons"</span><span class="p">,</span><span class="w"> </span><span class="n">show_labels</span><span class="o">=</span><span class="nb">F</span><span class="p">,</span><span class="w"> </span><span class="n">ggtheme</span><span class="o">=</span><span class="w"> </span><span class="n">ggthemes</span><span class="o">::</span><span class="n">theme_tufte</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/clustering/README-unnamed-chunk-57-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cutted</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cutree</span><span class="p">(</span><span class="n">h_cluster_l1_average</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">ARI_h_cluster_l1_average_3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">adjustedRandIndex</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span><span class="n">cutted</span><span class="p">)</span><span class="w">
</span><span class="n">print</span><span class="p">(</span><span class="n">ARI_h_cluster_l1_average_3</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] 1
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span><span class="w">
</span><span class="n">h_cluster_l1_complete</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hclust</span><span class="p">((</span><span class="n">l1_dist</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"complete"</span><span class="p">)</span><span class="w">
</span><span class="n">fviz_dend</span><span class="p">(</span><span class="n">h_cluster_l1_complete</span><span class="p">,</span><span class="w"> 
          </span><span class="n">main</span><span class="o">=</span><span class="s2">"Complete linkage with L1 based distance"</span><span class="p">,</span><span class="w"> 
          </span><span class="n">k</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">palette</span><span class="o">=</span><span class="w"> </span><span class="s2">"simpsons"</span><span class="p">,</span><span class="w"> </span><span class="n">show_labels</span><span class="o">=</span><span class="nb">F</span><span class="p">,</span><span class="w"> </span><span class="n">ggtheme</span><span class="o">=</span><span class="w"> </span><span class="n">ggthemes</span><span class="o">::</span><span class="n">theme_tufte</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/clustering/README-unnamed-chunk-59-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cutted</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cutree</span><span class="p">(</span><span class="n">h_cluster_l1_complete</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">ARI_h_cluster_l1_complete_3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">adjustedRandIndex</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span><span class="n">cutted</span><span class="p">)</span><span class="w">
</span><span class="n">print</span><span class="p">(</span><span class="n">ARI_h_cluster_l1_complete_3</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] 1
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span><span class="w">
</span><span class="n">max_dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dist</span><span class="p">(</span><span class="n">scale_data</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"max"</span><span class="p">)</span><span class="w">
</span><span class="n">h_cluster_max_average</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hclust</span><span class="p">((</span><span class="n">max_dist</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"average"</span><span class="p">)</span><span class="w">
</span><span class="n">fviz_dend</span><span class="p">(</span><span class="n">h_cluster_max_average</span><span class="p">,</span><span class="w"> 
          </span><span class="n">main</span><span class="o">=</span><span class="s2">"Average linkage with max based distance"</span><span class="p">,</span><span class="w"> 
          </span><span class="n">k</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="n">palette</span><span class="o">=</span><span class="w"> </span><span class="s2">"d3"</span><span class="p">,</span><span class="w"> </span><span class="n">show_labels</span><span class="o">=</span><span class="nb">F</span><span class="p">,</span><span class="w"> </span><span class="n">ggtheme</span><span class="o">=</span><span class="w"> </span><span class="n">ggthemes</span><span class="o">::</span><span class="n">theme_tufte</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/clustering/README-unnamed-chunk-61-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cutted</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cutree</span><span class="p">(</span><span class="n">h_cluster_max_average</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">ARI_h_cluster_max_average_3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">adjustedRandIndex</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span><span class="n">cutted</span><span class="p">)</span><span class="w">
</span><span class="n">print</span><span class="p">(</span><span class="n">ARI_h_cluster_max_average_3</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] -0.0101038
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span><span class="w">
</span><span class="n">h_cluster_max_complete</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hclust</span><span class="p">((</span><span class="n">max_dist</span><span class="p">),</span><span class="w"> </span><span class="n">method</span><span class="o">=</span><span class="s2">"complete"</span><span class="p">)</span><span class="w">
</span><span class="n">fviz_dend</span><span class="p">(</span><span class="n">h_cluster_max_complete</span><span class="p">,</span><span class="w"> 
          </span><span class="n">main</span><span class="o">=</span><span class="s2">"Complete linkage with max based distance"</span><span class="p">,</span><span class="w"> 
          </span><span class="n">k</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">palette</span><span class="o">=</span><span class="w"> </span><span class="s2">"d3"</span><span class="p">,</span><span class="w"> </span><span class="n">show_labels</span><span class="o">=</span><span class="nb">F</span><span class="p">,</span><span class="w"> </span><span class="n">ggtheme</span><span class="o">=</span><span class="w"> </span><span class="n">ggthemes</span><span class="o">::</span><span class="n">theme_tufte</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/clustering/README-unnamed-chunk-63-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cutted</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cutree</span><span class="p">(</span><span class="n">h_cluster_max_complete</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">ARI_h_cluster_max_complete_3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">adjustedRandIndex</span><span class="p">(</span><span class="n">truth</span><span class="p">,</span><span class="n">cutted</span><span class="p">)</span><span class="w">
</span><span class="n">print</span><span class="p">(</span><span class="n">ARI_h_cluster_max_complete_3</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] -0.0101038
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">results_third</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">Value</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">ARI_h_avg_reduced_3</span><span class="p">,</span><span class="w">
                                    </span><span class="n">ARI_h_complete_reduced_3</span><span class="p">,</span><span class="w">
                                    </span><span class="n">ARI_h_average_reduced_3</span><span class="p">,</span><span class="w">
                                    </span><span class="n">ARI_h_corr_complete_reduced_3</span><span class="p">,</span><span class="w">
                                    </span><span class="n">ARI_h_cluster_l1_average_3</span><span class="p">,</span><span class="w">
                                    </span><span class="n">ARI_h_cluster_l1_complete_3</span><span class="p">,</span><span class="w">
                                    </span><span class="n">ARI_h_cluster_max_average_3</span><span class="p">,</span><span class="w">
                                    </span><span class="n">ARI_h_cluster_max_complete_3</span><span class="p">),</span><span class="w">
                            </span><span class="n">Names</span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Average euclidean_3"</span><span class="p">,</span><span class="w"> 
                                     </span><span class="s2">"Complete euclidean_3"</span><span class="p">,</span><span class="w">
                                     </span><span class="s2">"Average correlation_3"</span><span class="p">,</span><span class="w">
                                     </span><span class="s2">"Complete correlation_3"</span><span class="p">,</span><span class="w">
                                     </span><span class="s2">"Complete L1_3"</span><span class="p">,</span><span class="w">
                                     </span><span class="s2">"Average L1_3"</span><span class="p">,</span><span class="w">
                                     </span><span class="s2">"Average Max_3"</span><span class="p">,</span><span class="w">
                                     </span><span class="s2">"Complete Max_3"</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">results_third</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">reorder</span><span class="p">(</span><span class="n">Names</span><span class="p">,</span><span class="w"> </span><span class="o">+</span><span class="n">Value</span><span class="p">),</span><span class="w"> </span><span class="n">x</span><span class="o">=</span><span class="n">Value</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="n">Names</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span><span class="o">=</span><span class="s2">"identity"</span><span class="p">)</span><span class="o">+</span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Ari ~ Methods"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">theme_tufte</span><span class="p">()</span><span class="o">+</span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"none"</span><span class="p">)</span><span class="o">+</span><span class="n">ylab</span><span class="p">(</span><span class="s2">"Method"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/clustering/README-unnamed-chunk-66-1.png" alt="" /><!-- --></p>

<p>Seems that with this last methods the results are improved, the cluster
analysis is equal to the subtype!.</p>

<p>To have a final understanding on our methods letâ€™s have one unique bar
plot having all the similarity together:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">final</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rbind</span><span class="p">(</span><span class="n">results_first</span><span class="p">,</span><span class="w"> </span><span class="n">results_second</span><span class="p">,</span><span class="n">results_third</span><span class="p">)</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">final</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">reorder</span><span class="p">(</span><span class="n">Names</span><span class="p">,</span><span class="w"> </span><span class="o">+</span><span class="n">Value</span><span class="p">),</span><span class="w"> </span><span class="n">x</span><span class="o">=</span><span class="n">Value</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="n">Names</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span><span class="o">=</span><span class="s2">"identity"</span><span class="p">)</span><span class="o">+</span><span class="n">theme_tufte</span><span class="p">()</span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Final ARI comparison between methods"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"none"</span><span class="p">)</span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"Method"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/clustering/README-unnamed-chunk-67-1.png" alt="" /><!-- --></p>

<p>Taking only the genes that vary the most across all the results
improved!</p>
:ET