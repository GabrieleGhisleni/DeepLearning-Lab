I"ʍ<h1 id="classification-models">Classification Models</h1>
<p>Gabriele Ghisleni</p>

<blockquote>
  <h1 id="exercise-1">Exercise 1</h1>

  <ul>
    <li>Load the data</li>
    <li>Perform basic data exploration</li>
    <li>Check the distributions of attributes</li>
    <li>Plot a scatterplot matrix between all the independent variables,
coloring the data by disease status</li>
    <li>Through plotting, try to understand which attributes are most
related to the outcome</li>
  </ul>
</blockquote>

<p>Let’s start by load our data: In this case is a comma separated value
file having the headers.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">pander</span><span class="p">)</span><span class="w">
</span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="s2">"disease.txt"</span><span class="p">,</span><span class="w"> </span><span class="n">header</span><span class="o">=</span><span class="nb">T</span><span class="p">)</span><span class="w">
</span><span class="n">pander</span><span class="p">(</span><span class="n">head</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="m">2</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<table>
  <thead>
    <tr>
      <th style="text-align: center">C1</th>
      <th style="text-align: center">C2</th>
      <th style="text-align: center">C3</th>
      <th style="text-align: center">C4</th>
      <th style="text-align: center">C5</th>
      <th style="text-align: center">C6</th>
      <th style="text-align: center">C7</th>
      <th style="text-align: center">C8</th>
      <th style="text-align: center">disease</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">3</td>
      <td style="text-align: center">83</td>
      <td style="text-align: center">58</td>
      <td style="text-align: center">31</td>
      <td style="text-align: center">18</td>
      <td style="text-align: center">34.3</td>
      <td style="text-align: center">0.336</td>
      <td style="text-align: center">25</td>
      <td style="text-align: center">0</td>
    </tr>
    <tr>
      <td style="text-align: center">0</td>
      <td style="text-align: center">94</td>
      <td style="text-align: center">70</td>
      <td style="text-align: center">27</td>
      <td style="text-align: center">115</td>
      <td style="text-align: center">43.5</td>
      <td style="text-align: center">0.347</td>
      <td style="text-align: center">21</td>
      <td style="text-align: center">0</td>
    </tr>
  </tbody>
</table>

<p>More in detail let’s see how our variables are encoded:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">str</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## 'data.frame':    392 obs. of  9 variables:
##  $ C1     : int  3 0 0 1 0 0 2 5 2 3 ...
##  $ C2     : int  83 94 128 153 95 126 90 121 108 176 ...
##  $ C3     : int  58 70 68 82 80 84 80 72 62 86 ...
##  $ C4     : int  31 27 19 42 45 29 14 23 32 27 ...
##  $ C5     : int  18 115 180 485 92 215 55 112 56 156 ...
##  $ C6     : num  34.3 43.5 30.5 40.6 36.5 30.7 24.4 26.2 25.2 33.3 ...
##  $ C7     : num  0.336 0.347 1.391 0.687 0.33 ...
##  $ C8     : int  25 21 25 23 26 24 24 30 21 52 ...
##  $ disease: int  0 0 1 0 0 0 0 0 0 1 ...
</code></pre></div></div>

<p>Looking at the variable “disease” which is categorical, and the target
of our future analysis, is marked as integer so we specify to R to treat
it as a factor(with the following labels: 0 = “N”, 1 = “Y”)</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w">
</span><span class="n">df</span><span class="p">[</span><span class="s2">"disease"</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">disease</span><span class="p">,</span><span class="w"> </span><span class="n">levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"N"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Y"</span><span class="p">))</span><span class="w">
</span><span class="n">xx</span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">disease</span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"N"</span><span class="p">,</span><span class="s2">"Y"</span><span class="p">),</span><span class="w"> </span><span class="n">f</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">262</span><span class="p">,</span><span class="m">130</span><span class="p">))</span><span class="w"> </span><span class="c1"># from count table</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">xx</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="n">disease</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span><span class="o">=</span><span class="s2">"identity"</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s2">"black"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">coord_polar</span><span class="p">(</span><span class="s2">"y"</span><span class="p">,</span><span class="w"> </span><span class="n">start</span><span class="o">=</span><span class="m">0</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">"Pie Chart of the target variable 'disease'"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">xlab</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">ylab</span><span class="p">(</span><span class="s2">""</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"top"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_text</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">xx</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">f</span><span class="p">),</span><span class="w"> </span><span class="n">vjust</span><span class="o">=</span><span class="m">-4</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">scale_fill_brewer</span><span class="p">(</span><span class="n">palette</span><span class="o">=</span><span class="s2">"Set2"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">theme_minimal</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/classification-models/README-unnamed-chunk-4-1.png" alt="" /><!-- --></p>

<p>From this piechart we can see that the class is quit unbalanced. An
other basic operation is checkhing the presence of NA’s in the data and
in case handle them:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">df</span><span class="p">))){</span><span class="w">
  </span><span class="n">tmp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">df</span><span class="p">[,</span><span class="n">i</span><span class="p">]))</span><span class="w">
  </span><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"Number of NA in column"</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="s2">"is"</span><span class="p">,</span><span class="w"> </span><span class="n">tmp</span><span class="p">))}</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "Number of NA in column 1 is 0"
## [1] "Number of NA in column 2 is 0"
## [1] "Number of NA in column 3 is 0"
## [1] "Number of NA in column 4 is 0"
## [1] "Number of NA in column 5 is 0"
## [1] "Number of NA in column 6 is 0"
## [1] "Number of NA in column 7 is 0"
## [1] "Number of NA in column 8 is 0"
## [1] "Number of NA in column 9 is 0"
</code></pre></div></div>

<p>Na’s are not present. So we can perform a summary on the data frame and
see basic statistics about the variables (as the min, max, quantiles,
mean) on the numeric columns:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pander</span><span class="p">(</span><span class="n">summary</span><span class="p">(</span><span class="n">df</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<table>
  <thead>
    <tr>
      <th style="text-align: center">C1</th>
      <th style="text-align: center">C2</th>
      <th style="text-align: center">C3</th>
      <th style="text-align: center">C4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">Min. : 0.000</td>
      <td style="text-align: center">Min. : 56.0</td>
      <td style="text-align: center">Min. : 24.00</td>
      <td style="text-align: center">Min. : 7.00</td>
    </tr>
    <tr>
      <td style="text-align: center">1st Qu.: 1.000</td>
      <td style="text-align: center">1st Qu.: 99.0</td>
      <td style="text-align: center">1st Qu.: 62.00</td>
      <td style="text-align: center">1st Qu.:21.00</td>
    </tr>
    <tr>
      <td style="text-align: center">Median : 2.000</td>
      <td style="text-align: center">Median :119.0</td>
      <td style="text-align: center">Median : 70.00</td>
      <td style="text-align: center">Median :29.00</td>
    </tr>
    <tr>
      <td style="text-align: center">Mean : 3.301</td>
      <td style="text-align: center">Mean :122.6</td>
      <td style="text-align: center">Mean : 70.66</td>
      <td style="text-align: center">Mean :29.15</td>
    </tr>
    <tr>
      <td style="text-align: center">3rd Qu.: 5.000</td>
      <td style="text-align: center">3rd Qu.:143.0</td>
      <td style="text-align: center">3rd Qu.: 78.00</td>
      <td style="text-align: center">3rd Qu.:37.00</td>
    </tr>
    <tr>
      <td style="text-align: center">Max. :17.000</td>
      <td style="text-align: center">Max. :198.0</td>
      <td style="text-align: center">Max. :110.00</td>
      <td style="text-align: center">Max. :63.00</td>
    </tr>
  </tbody>
</table>

<p>Table continues below</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">C5</th>
      <th style="text-align: center">C6</th>
      <th style="text-align: center">C7</th>
      <th style="text-align: center">C8</th>
      <th style="text-align: center">disease</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">Min. : 14.00</td>
      <td style="text-align: center">Min. :18.20</td>
      <td style="text-align: center">Min. :0.0850</td>
      <td style="text-align: center">Min. :21.00</td>
      <td style="text-align: center">N:262</td>
    </tr>
    <tr>
      <td style="text-align: center">1st Qu.: 76.75</td>
      <td style="text-align: center">1st Qu.:28.40</td>
      <td style="text-align: center">1st Qu.:0.2697</td>
      <td style="text-align: center">1st Qu.:23.00</td>
      <td style="text-align: center">Y:130</td>
    </tr>
    <tr>
      <td style="text-align: center">Median :125.50</td>
      <td style="text-align: center">Median :33.20</td>
      <td style="text-align: center">Median :0.4495</td>
      <td style="text-align: center">Median :27.00</td>
      <td style="text-align: center">NA</td>
    </tr>
    <tr>
      <td style="text-align: center">Mean :156.06</td>
      <td style="text-align: center">Mean :33.09</td>
      <td style="text-align: center">Mean :0.5230</td>
      <td style="text-align: center">Mean :30.86</td>
      <td style="text-align: center">NA</td>
    </tr>
    <tr>
      <td style="text-align: center">3rd Qu.:190.00</td>
      <td style="text-align: center">3rd Qu.:37.10</td>
      <td style="text-align: center">3rd Qu.:0.6870</td>
      <td style="text-align: center">3rd Qu.:36.00</td>
      <td style="text-align: center">NA</td>
    </tr>
    <tr>
      <td style="text-align: center">Max. :846.00</td>
      <td style="text-align: center">Max. :67.10</td>
      <td style="text-align: center">Max. :2.4200</td>
      <td style="text-align: center">Max. :81.00</td>
      <td style="text-align: center">NA</td>
    </tr>
  </tbody>
</table>

<p>We are also interested in other basics statistics as the median and the
standard deviation:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">descriptive_stat_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">()</span><span class="w">
</span><span class="n">names</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">colnames</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="w">
</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">8</span><span class="p">){</span><span class="w">    </span><span class="c1"># -1 because the last columns if factor</span><span class="w">
   </span><span class="n">descriptive_stat_df</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="s2">"Variable"</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w">
   </span><span class="n">descriptive_stat_df</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="s2">"Mean"</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">df</span><span class="p">[,</span><span class="n">i</span><span class="p">])</span><span class="w">
   </span><span class="n">descriptive_stat_df</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="s2">"sd"</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sd</span><span class="p">(</span><span class="n">df</span><span class="p">[,</span><span class="n">i</span><span class="p">])</span><span class="w">
   </span><span class="n">descriptive_stat_df</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="s2">"Median"</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">median</span><span class="p">(</span><span class="n">df</span><span class="p">[,</span><span class="n">i</span><span class="p">])}</span><span class="w">
</span><span class="n">pander</span><span class="p">(</span><span class="n">descriptive_stat_df</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Variable</th>
      <th style="text-align: center">Mean</th>
      <th style="text-align: center">sd</th>
      <th style="text-align: center">Median</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">C1</td>
      <td style="text-align: center">3.301</td>
      <td style="text-align: center">3.211</td>
      <td style="text-align: center">2</td>
    </tr>
    <tr>
      <td style="text-align: center">C2</td>
      <td style="text-align: center">122.6</td>
      <td style="text-align: center">30.86</td>
      <td style="text-align: center">119</td>
    </tr>
    <tr>
      <td style="text-align: center">C3</td>
      <td style="text-align: center">70.66</td>
      <td style="text-align: center">12.5</td>
      <td style="text-align: center">70</td>
    </tr>
    <tr>
      <td style="text-align: center">C4</td>
      <td style="text-align: center">29.15</td>
      <td style="text-align: center">10.52</td>
      <td style="text-align: center">29</td>
    </tr>
    <tr>
      <td style="text-align: center">C5</td>
      <td style="text-align: center">156.1</td>
      <td style="text-align: center">118.8</td>
      <td style="text-align: center">125.5</td>
    </tr>
    <tr>
      <td style="text-align: center">C6</td>
      <td style="text-align: center">33.09</td>
      <td style="text-align: center">7.028</td>
      <td style="text-align: center">33.2</td>
    </tr>
    <tr>
      <td style="text-align: center">C7</td>
      <td style="text-align: center">0.523</td>
      <td style="text-align: center">0.3455</td>
      <td style="text-align: center">0.4495</td>
    </tr>
    <tr>
      <td style="text-align: center">C8</td>
      <td style="text-align: center">30.86</td>
      <td style="text-align: center">10.2</td>
      <td style="text-align: center">27</td>
    </tr>
  </tbody>
</table>

<p>Let’s also see this statistical features but performing the operation
dividing the data frame into 2 groups, the disease = “Y” and =“N”.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">$</span><span class="n">disease</span><span class="o">==</span><span class="s2">"N"</span><span class="p">,</span><span class="m">-9</span><span class="p">]</span><span class="w">
</span><span class="n">df_y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">$</span><span class="n">disease</span><span class="o">==</span><span class="s2">"Y"</span><span class="p">,</span><span class="m">-9</span><span class="p">]</span><span class="w">
</span><span class="n">pander</span><span class="p">(</span><span class="n">summary</span><span class="p">(</span><span class="n">df_n</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<table>
  <thead>
    <tr>
      <th style="text-align: center">C1</th>
      <th style="text-align: center">C2</th>
      <th style="text-align: center">C3</th>
      <th style="text-align: center">C4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">Min. : 0.000</td>
      <td style="text-align: center">Min. : 56.0</td>
      <td style="text-align: center">Min. : 24.00</td>
      <td style="text-align: center">Min. : 7.00</td>
    </tr>
    <tr>
      <td style="text-align: center">1st Qu.: 1.000</td>
      <td style="text-align: center">1st Qu.: 94.0</td>
      <td style="text-align: center">1st Qu.: 60.00</td>
      <td style="text-align: center">1st Qu.:18.25</td>
    </tr>
    <tr>
      <td style="text-align: center">Median : 2.000</td>
      <td style="text-align: center">Median :107.5</td>
      <td style="text-align: center">Median : 70.00</td>
      <td style="text-align: center">Median :27.00</td>
    </tr>
    <tr>
      <td style="text-align: center">Mean : 2.721</td>
      <td style="text-align: center">Mean :111.4</td>
      <td style="text-align: center">Mean : 68.97</td>
      <td style="text-align: center">Mean :27.25</td>
    </tr>
    <tr>
      <td style="text-align: center">3rd Qu.: 4.000</td>
      <td style="text-align: center">3rd Qu.:126.0</td>
      <td style="text-align: center">3rd Qu.: 76.00</td>
      <td style="text-align: center">3rd Qu.:34.00</td>
    </tr>
    <tr>
      <td style="text-align: center">Max. :13.000</td>
      <td style="text-align: center">Max. :197.0</td>
      <td style="text-align: center">Max. :106.00</td>
      <td style="text-align: center">Max. :60.00</td>
    </tr>
  </tbody>
</table>

<p>Table continues below</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">C5</th>
      <th style="text-align: center">C6</th>
      <th style="text-align: center">C7</th>
      <th style="text-align: center">C8</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">Min. : 15.0</td>
      <td style="text-align: center">Min. :18.20</td>
      <td style="text-align: center">Min. :0.0850</td>
      <td style="text-align: center">Min. :21.00</td>
    </tr>
    <tr>
      <td style="text-align: center">1st Qu.: 66.0</td>
      <td style="text-align: center">1st Qu.:26.12</td>
      <td style="text-align: center">1st Qu.:0.2610</td>
      <td style="text-align: center">1st Qu.:22.00</td>
    </tr>
    <tr>
      <td style="text-align: center">Median :105.0</td>
      <td style="text-align: center">Median :31.25</td>
      <td style="text-align: center">Median :0.4135</td>
      <td style="text-align: center">Median :25.00</td>
    </tr>
    <tr>
      <td style="text-align: center">Mean :130.9</td>
      <td style="text-align: center">Mean :31.75</td>
      <td style="text-align: center">Mean :0.4722</td>
      <td style="text-align: center">Mean :28.35</td>
    </tr>
    <tr>
      <td style="text-align: center">3rd Qu.:163.8</td>
      <td style="text-align: center">3rd Qu.:36.10</td>
      <td style="text-align: center">3rd Qu.:0.6242</td>
      <td style="text-align: center">3rd Qu.:30.00</td>
    </tr>
    <tr>
      <td style="text-align: center">Max. :744.0</td>
      <td style="text-align: center">Max. :57.30</td>
      <td style="text-align: center">Max. :2.3290</td>
      <td style="text-align: center">Max. :81.00</td>
    </tr>
  </tbody>
</table>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pander</span><span class="p">(</span><span class="n">summary</span><span class="p">(</span><span class="n">df_y</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<table>
  <thead>
    <tr>
      <th style="text-align: center">C1</th>
      <th style="text-align: center">C2</th>
      <th style="text-align: center">C3</th>
      <th style="text-align: center">C4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">Min. : 0.000</td>
      <td style="text-align: center">Min. : 78.0</td>
      <td style="text-align: center">Min. : 30.00</td>
      <td style="text-align: center">Min. : 7.00</td>
    </tr>
    <tr>
      <td style="text-align: center">1st Qu.: 1.000</td>
      <td style="text-align: center">1st Qu.:124.2</td>
      <td style="text-align: center">1st Qu.: 66.50</td>
      <td style="text-align: center">1st Qu.:26.00</td>
    </tr>
    <tr>
      <td style="text-align: center">Median : 3.000</td>
      <td style="text-align: center">Median :144.5</td>
      <td style="text-align: center">Median : 74.00</td>
      <td style="text-align: center">Median :33.00</td>
    </tr>
    <tr>
      <td style="text-align: center">Mean : 4.469</td>
      <td style="text-align: center">Mean :145.2</td>
      <td style="text-align: center">Mean : 74.08</td>
      <td style="text-align: center">Mean :32.96</td>
    </tr>
    <tr>
      <td style="text-align: center">3rd Qu.: 7.000</td>
      <td style="text-align: center">3rd Qu.:171.8</td>
      <td style="text-align: center">3rd Qu.: 82.00</td>
      <td style="text-align: center">3rd Qu.:39.75</td>
    </tr>
    <tr>
      <td style="text-align: center">Max. :17.000</td>
      <td style="text-align: center">Max. :198.0</td>
      <td style="text-align: center">Max. :110.00</td>
      <td style="text-align: center">Max. :63.00</td>
    </tr>
  </tbody>
</table>

<p>Table continues below</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">C5</th>
      <th style="text-align: center">C6</th>
      <th style="text-align: center">C7</th>
      <th style="text-align: center">C8</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">Min. : 14.0</td>
      <td style="text-align: center">Min. :22.90</td>
      <td style="text-align: center">Min. :0.1270</td>
      <td style="text-align: center">Min. :21.00</td>
    </tr>
    <tr>
      <td style="text-align: center">1st Qu.:127.5</td>
      <td style="text-align: center">1st Qu.:31.60</td>
      <td style="text-align: center">1st Qu.:0.3297</td>
      <td style="text-align: center">1st Qu.:27.25</td>
    </tr>
    <tr>
      <td style="text-align: center">Median :169.5</td>
      <td style="text-align: center">Median :34.60</td>
      <td style="text-align: center">Median :0.5460</td>
      <td style="text-align: center">Median :33.00</td>
    </tr>
    <tr>
      <td style="text-align: center">Mean :206.8</td>
      <td style="text-align: center">Mean :35.78</td>
      <td style="text-align: center">Mean :0.6256</td>
      <td style="text-align: center">Mean :35.94</td>
    </tr>
    <tr>
      <td style="text-align: center">3rd Qu.:239.2</td>
      <td style="text-align: center">3rd Qu.:38.35</td>
      <td style="text-align: center">3rd Qu.:0.7865</td>
      <td style="text-align: center">3rd Qu.:43.00</td>
    </tr>
    <tr>
      <td style="text-align: center">Max. :846.0</td>
      <td style="text-align: center">Max. :67.10</td>
      <td style="text-align: center">Max. :2.4200</td>
      <td style="text-align: center">Max. :60.00</td>
    </tr>
  </tbody>
</table>

<p>From this view it seems that all the variables have the median close to
the mean except for the variable C5 and C8 (different between
quantiles). To check if there could be some outliers we use box plots.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">C5</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="n">disease</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_boxplot</span><span class="p">(</span><span class="n">show.legend</span><span class="o">=</span><span class="nb">T</span><span class="p">)</span><span class="o">+</span><span class="w"> 
  </span><span class="n">theme_bw</span><span class="p">()</span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"top"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Boxplot C5 ~ Disease"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">disease</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/classification-models/README-unnamed-chunk-10-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">C8</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="n">disease</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_boxplot</span><span class="p">(</span><span class="n">show.legend</span><span class="o">=</span><span class="nb">T</span><span class="p">)</span><span class="o">+</span><span class="w"> 
  </span><span class="n">theme_bw</span><span class="p">()</span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"top"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Boxplot C8 ~ Disease"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">disease</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/classification-models/README-unnamed-chunk-11-1.png" alt="" /><!-- --></p>

<p>Looking at those box plots we can see that there is the possibility that
some points were outliers. By now we are not sure and we do nothing, we
just keep in mind this situation.</p>

<p>Let’s see the distribution of our variables. Since we will perform the
same operations on all the variables, we will explain step by step only
the first and the others will follow the same reasoning. Since two are
challenges, we left them last.</p>

<h2 id="looking-at-the-distributions">Looking at the distributions</h2>

<p>The steps are: - Looking at the distribution of the data performing an
histogram or a bar plot. - Try to understand what kind of distribution
is. - Perform the MLE and find the parameters that fit best the
distribution. - Create new arbitrary data with same distribution and
same parameters. - Overlay the new data as a line upon the histogram.</p>

<p>Start with C2: First plot an histogram alone and see what it looks like.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">C2</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">..density..</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_histogram</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s2">"royalblue"</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s2">"black"</span><span class="p">,</span><span class="w"> </span><span class="n">bins</span><span class="o">=</span><span class="m">15</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="m">0.7</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"C2 Histogram"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Real data"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/classification-models/README-unnamed-chunk-12-1.png" alt="" /><!-- --></p>

<p>The distribution seems a Gamma. So we will try to find the optimal
parameters that fit a gamma distribution using the maximum likelihood
estimation. To do that we will use the library bbmle and the function
mle2 that requires a function that returns the minus sum of log
likelihood of our data.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">bbmle</span><span class="p">)</span><span class="w">
</span><span class="n">llgamma</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span><span class="w"> </span><span class="n">scale</span><span class="p">){</span><span class="w">
  </span><span class="o">-</span><span class="nf">sum</span><span class="p">(</span><span class="n">dgamma</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">C2</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">shape</span><span class="p">,</span><span class="w"> </span><span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span><span class="w"> </span><span class="n">log</span><span class="o">=</span><span class="nb">T</span><span class="p">))</span><span class="w"> </span><span class="p">}</span><span class="w">
</span><span class="n">mleG</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mle2</span><span class="p">(</span><span class="n">llgamma</span><span class="p">,</span><span class="w"> </span><span class="n">start</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">scale</span><span class="o">=</span><span class="m">1</span><span class="p">))</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">mleG</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## Maximum likelihood estimation
## 
## Call:
## mle2(minuslogl = llgamma, start = list(shape = 1, scale = 1))
## 
## Coefficients:
##       Estimate Std. Error z value     Pr(z)    
## shape 16.24150    1.14841  14.143 &lt; 2.2e-16 ***
## scale  7.55026    0.54219  13.926 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## -2 log L: 3773.729
</code></pre></div></div>

<p>The warnings are not important. The estimation result return a shape
around 16 and a scale around 7.5. Now we create new arbitrary data that
follow a gamma distribution having the same parameters and then we will
overlay this data over our real histogram.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">xx</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">40</span><span class="p">,</span><span class="m">220</span><span class="p">,</span><span class="w"> </span><span class="n">len</span><span class="o">=</span><span class="m">300</span><span class="p">)</span><span class="w">
</span><span class="n">yy</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dgamma</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mleG</span><span class="o">@</span><span class="n">coef</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">scale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mleG</span><span class="o">@</span><span class="n">coef</span><span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="w">
</span><span class="n">gammaDF</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">xx</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="o">=</span><span class="n">yy</span><span class="p">)</span><span class="w">
</span><span class="n">shape</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">mleG</span><span class="o">@</span><span class="n">coef</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">scale</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">mleG</span><span class="o">@</span><span class="n">coef</span><span class="p">[</span><span class="m">2</span><span class="p">],</span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">C2</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_histogram</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">..density..</span><span class="p">),</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s2">"black"</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="s2">"royalblue"</span><span class="p">,</span><span class="w"> </span><span class="n">bins</span><span class="o">=</span><span class="m">15</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="m">0.7</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">gammaDF</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="o">=</span><span class="s2">"Simulated distribution"</span><span class="p">),</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">scale_color_manual</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"salmon2"</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">"C2 Histogram"</span><span class="p">,</span><span class="w"> </span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"The blue histogram represents the actual distribution"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">subtitle</span><span class="o">=</span><span class="w"> </span><span class="n">paste</span><span class="p">(</span><span class="s2">"Simulated distribution ~ Gamma (shape ="</span><span class="p">,</span><span class="n">shape</span><span class="p">,</span><span class="s2">",scale ="</span><span class="p">,</span><span class="n">scale</span><span class="p">,</span><span class="s2">")"</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">theme_light</span><span class="p">()</span><span class="o">+</span><span class="w">  </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"top"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/classification-models/README-unnamed-chunk-14-1.png" alt="" /><!-- --></p>

<p>Now that we have illustrated the method we will perform quicker the same
on the remains variables:</p>

<ul>
  <li>C3:</li>
</ul>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">llnorm</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span><span class="w"> </span><span class="n">sigma</span><span class="p">){</span><span class="w">
  </span><span class="o">-</span><span class="nf">sum</span><span class="p">(</span><span class="n">dnorm</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">C3</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="w"> </span><span class="n">log</span><span class="o">=</span><span class="nb">T</span><span class="p">))}</span><span class="w">
</span><span class="n">mleN</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mle2</span><span class="p">(</span><span class="n">llnorm</span><span class="p">,</span><span class="w"> </span><span class="n">start</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="m">60</span><span class="p">,</span><span class="w"> </span><span class="n">sigma</span><span class="o">=</span><span class="m">20</span><span class="p">))</span><span class="w">

</span><span class="n">xx</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">15</span><span class="p">,</span><span class="m">120</span><span class="p">,</span><span class="n">len</span><span class="o">=</span><span class="m">1000</span><span class="p">)</span><span class="w">
</span><span class="n">yy</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dnorm</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="w"> </span><span class="n">mleN</span><span class="o">@</span><span class="n">coef</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">mleN</span><span class="o">@</span><span class="n">coef</span><span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="w">
</span><span class="n">Simulated_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="s2">"salmon2"</span><span class="p">,</span><span class="w"> </span><span class="m">1000</span><span class="p">)</span><span class="w">
</span><span class="n">normDF</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">xx</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="o">=</span><span class="n">yy</span><span class="p">)</span><span class="w">

</span><span class="n">mu</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">mleN</span><span class="o">@</span><span class="n">coef</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">sigma</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">mleN</span><span class="o">@</span><span class="n">coef</span><span class="p">[</span><span class="m">2</span><span class="p">],</span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">C3</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_histogram</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">..density..</span><span class="p">),</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s2">"black"</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="s2">"royalblue"</span><span class="p">,</span><span class="w"> </span><span class="n">bins</span><span class="o">=</span><span class="m">15</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="m">0.7</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">normDF</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="o">=</span><span class="s2">"Simulated distribution"</span><span class="p">),</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">scale_color_manual</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"salmon2"</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">"C3 Histogram"</span><span class="p">,</span><span class="w"> </span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"The blue histogram represents the actual distribution"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">subtitle</span><span class="o">=</span><span class="w"> </span><span class="n">paste</span><span class="p">(</span><span class="s2">"Simulated distribution ~ Norm (mu ="</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="s2">",sigma ="</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="s2">")"</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">theme_light</span><span class="p">()</span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"top"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/classification-models/README-unnamed-chunk-15-1.png" alt="" /><!-- --></p>

<ul>
  <li>C4:</li>
</ul>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">llnorm</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span><span class="w"> </span><span class="n">sigma</span><span class="p">){</span><span class="w">
  </span><span class="o">-</span><span class="nf">sum</span><span class="p">(</span><span class="n">dnorm</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">C4</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="w"> </span><span class="n">log</span><span class="o">=</span><span class="nb">T</span><span class="p">))}</span><span class="w">
</span><span class="n">mleN</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mle2</span><span class="p">(</span><span class="n">llnorm</span><span class="p">,</span><span class="w"> </span><span class="n">start</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="n">sigma</span><span class="o">=</span><span class="m">10</span><span class="p">))</span><span class="w">

</span><span class="n">xx</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">65</span><span class="p">,</span><span class="n">len</span><span class="o">=</span><span class="m">1000</span><span class="p">)</span><span class="w">
</span><span class="n">yy</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dnorm</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="w"> </span><span class="n">mleN</span><span class="o">@</span><span class="n">coef</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">mleN</span><span class="o">@</span><span class="n">coef</span><span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="w">
</span><span class="n">normDF</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">xx</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="o">=</span><span class="n">yy</span><span class="p">)</span><span class="w">

</span><span class="n">mu</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">mleN</span><span class="o">@</span><span class="n">coef</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">sigma</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">mleN</span><span class="o">@</span><span class="n">coef</span><span class="p">[</span><span class="m">2</span><span class="p">],</span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">C4</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_histogram</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">..density..</span><span class="p">),</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s2">"black"</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="s2">"royalblue"</span><span class="p">,</span><span class="w"> </span><span class="n">bins</span><span class="o">=</span><span class="m">15</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="m">0.7</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">normDF</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="o">=</span><span class="s2">"Simulated distribution"</span><span class="p">),</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">scale_color_manual</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"salmon2"</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">"C4 Histogram"</span><span class="p">,</span><span class="w"> </span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"The blue histogram represents the actual distribution"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">subtitle</span><span class="o">=</span><span class="w"> </span><span class="n">paste</span><span class="p">(</span><span class="s2">"Simulated distribution ~ Norm (mu ="</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="s2">",sigma ="</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="s2">")"</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">theme_light</span><span class="p">()</span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"top"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/classification-models/README-unnamed-chunk-16-1.png" alt="" /><!-- --></p>

<ul>
  <li>C5:</li>
</ul>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">llgamma</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span><span class="w"> </span><span class="n">scale</span><span class="p">){</span><span class="w">
  </span><span class="o">-</span><span class="nf">sum</span><span class="p">(</span><span class="n">dgamma</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">C5</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">shape</span><span class="p">,</span><span class="w"> </span><span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span><span class="w"> </span><span class="n">log</span><span class="o">=</span><span class="nb">T</span><span class="p">))</span><span class="w"> </span><span class="p">}</span><span class="w">
</span><span class="n">mleG</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mle2</span><span class="p">(</span><span class="n">llgamma</span><span class="p">,</span><span class="w"> </span><span class="n">start</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">scale</span><span class="o">=</span><span class="m">1</span><span class="p">))</span><span class="w">
</span><span class="n">xx</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">700</span><span class="p">)</span><span class="w">
</span><span class="n">yy</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dgamma</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mleG</span><span class="o">@</span><span class="n">coef</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">scale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mleG</span><span class="o">@</span><span class="n">coef</span><span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="w">
</span><span class="n">gammaDF</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">xx</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="o">=</span><span class="n">yy</span><span class="p">)</span><span class="w">
</span><span class="n">shape</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">mleG</span><span class="o">@</span><span class="n">coef</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">scale</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">mleG</span><span class="o">@</span><span class="n">coef</span><span class="p">[</span><span class="m">2</span><span class="p">],</span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">C5</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_histogram</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">..density..</span><span class="p">),</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s2">"black"</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="s2">"royalblue"</span><span class="p">,</span><span class="w"> </span><span class="n">bins</span><span class="o">=</span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="m">0.7</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">gammaDF</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="o">=</span><span class="s2">"Simulated distribution"</span><span class="p">),</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">scale_color_manual</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"salmon2"</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">"C5 Histogram"</span><span class="p">,</span><span class="w"> </span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"The blue histogram represents the actual distribution"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">subtitle</span><span class="o">=</span><span class="w"> </span><span class="n">paste</span><span class="p">(</span><span class="s2">"Simulated distribution ~ Gamma (shape ="</span><span class="p">,</span><span class="n">shape</span><span class="p">,</span><span class="s2">",scale ="</span><span class="p">,</span><span class="n">scale</span><span class="p">,</span><span class="s2">")"</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">theme_light</span><span class="p">()</span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"top"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/classification-models/README-unnamed-chunk-17-1.png" alt="" /><!-- --></p>

<ul>
  <li>C6:</li>
</ul>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">llnorm</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span><span class="w"> </span><span class="n">sigma</span><span class="p">){</span><span class="w">
  </span><span class="o">-</span><span class="nf">sum</span><span class="p">(</span><span class="n">dnorm</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">C6</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="w"> </span><span class="n">log</span><span class="o">=</span><span class="nb">T</span><span class="p">))}</span><span class="w">
</span><span class="n">mleN</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mle2</span><span class="p">(</span><span class="n">llnorm</span><span class="p">,</span><span class="w"> </span><span class="n">start</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="n">sigma</span><span class="o">=</span><span class="m">10</span><span class="p">))</span><span class="w">

</span><span class="n">xx</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">10</span><span class="p">,</span><span class="m">70</span><span class="p">,</span><span class="n">len</span><span class="o">=</span><span class="m">1000</span><span class="p">)</span><span class="w">
</span><span class="n">yy</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dnorm</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="w"> </span><span class="n">mleN</span><span class="o">@</span><span class="n">coef</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">mleN</span><span class="o">@</span><span class="n">coef</span><span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="w">
</span><span class="n">normDF</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">xx</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="o">=</span><span class="n">yy</span><span class="p">)</span><span class="w">

</span><span class="n">mu</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">mleN</span><span class="o">@</span><span class="n">coef</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">sigma</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">mleN</span><span class="o">@</span><span class="n">coef</span><span class="p">[</span><span class="m">2</span><span class="p">],</span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">C6</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_histogram</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">..density..</span><span class="p">),</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s2">"black"</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="s2">"royalblue"</span><span class="p">,</span><span class="w"> </span><span class="n">bins</span><span class="o">=</span><span class="m">50</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="m">0.7</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">normDF</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="o">=</span><span class="s2">"Simulated distribution"</span><span class="p">),</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">scale_color_manual</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"salmon2"</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">"C6 Histogram"</span><span class="p">,</span><span class="w"> </span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"The blue histogram represents the actual distribution"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">subtitle</span><span class="o">=</span><span class="w"> </span><span class="n">paste</span><span class="p">(</span><span class="s2">"Simulated distribution ~ Norm (mu ="</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="s2">",sigma ="</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="s2">")"</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">theme_light</span><span class="p">()</span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"top"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/classification-models/README-unnamed-chunk-18-1.png" alt="" /><!-- --></p>

<ul>
  <li>C7:</li>
</ul>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">llgamma</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span><span class="w"> </span><span class="n">scale</span><span class="p">){</span><span class="w">
  </span><span class="o">-</span><span class="nf">sum</span><span class="p">(</span><span class="n">dgamma</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">C7</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">shape</span><span class="p">,</span><span class="w"> </span><span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span><span class="w"> </span><span class="n">log</span><span class="o">=</span><span class="nb">T</span><span class="p">))</span><span class="w"> </span><span class="p">}</span><span class="w">
</span><span class="n">mleG</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mle2</span><span class="p">(</span><span class="n">llgamma</span><span class="p">,</span><span class="w"> </span><span class="n">start</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">scale</span><span class="o">=</span><span class="m">1</span><span class="p">))</span><span class="w">
</span><span class="n">xx</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="n">len</span><span class="o">=</span><span class="m">100</span><span class="p">)</span><span class="w">
</span><span class="n">yy</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dgamma</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mleG</span><span class="o">@</span><span class="n">coef</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">scale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mleG</span><span class="o">@</span><span class="n">coef</span><span class="p">[</span><span class="m">2</span><span class="p">])</span><span class="w">
</span><span class="n">gammaDF</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">xx</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="o">=</span><span class="n">yy</span><span class="p">)</span><span class="w">
</span><span class="n">shape</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">mleG</span><span class="o">@</span><span class="n">coef</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">scale</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">mleG</span><span class="o">@</span><span class="n">coef</span><span class="p">[</span><span class="m">2</span><span class="p">],</span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">C7</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_histogram</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">..density..</span><span class="p">),</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s2">"black"</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="s2">"royalblue"</span><span class="p">,</span><span class="w"> </span><span class="n">bins</span><span class="o">=</span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="m">0.7</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">gammaDF</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="o">=</span><span class="s2">"Simulated distribution"</span><span class="p">),</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">scale_color_manual</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"salmon2"</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">"C7 Histogram"</span><span class="p">,</span><span class="w"> </span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"The blue histogram represents the actual distribution"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">subtitle</span><span class="o">=</span><span class="w"> </span><span class="n">paste</span><span class="p">(</span><span class="s2">"Simulated distribution ~ Gamma (shape ="</span><span class="p">,</span><span class="n">shape</span><span class="p">,</span><span class="s2">",scale ="</span><span class="p">,</span><span class="n">scale</span><span class="p">,</span><span class="s2">")"</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">theme_light</span><span class="p">()</span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"top"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/classification-models/README-unnamed-chunk-19-1.png" alt="" /><!-- --></p>

<p>We left the two most problematic variables: C1 and C8. These two have no
clear distribution, we will use the package fitdistrplus to try to
understand properly the distribution:</p>

<p>. C8: Try different distribution and plot over the data.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">fitdistrplus</span><span class="p">)</span><span class="w">
</span><span class="n">fit.exp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fitdist</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">C8</span><span class="p">,</span><span class="w"> </span><span class="s2">"exp"</span><span class="p">,</span><span class="w"> </span><span class="n">discrete</span><span class="o">=</span><span class="nb">T</span><span class="p">)</span><span class="w">
</span><span class="n">fit.lnorm</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fitdist</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">C8</span><span class="p">,</span><span class="w"> </span><span class="s2">"lnorm"</span><span class="p">,</span><span class="w"> </span><span class="n">discrete</span><span class="o">=</span><span class="nb">T</span><span class="p">)</span><span class="w">
</span><span class="n">fit.gamma</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fitdist</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">C8</span><span class="p">,</span><span class="w"> </span><span class="s2">"gamma"</span><span class="p">,</span><span class="w"> </span><span class="n">discrete</span><span class="o">=</span><span class="nb">T</span><span class="p">)</span><span class="w">


</span><span class="n">xx</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">18</span><span class="p">,</span><span class="m">70</span><span class="p">,</span><span class="n">len</span><span class="o">=</span><span class="m">1000</span><span class="p">)</span><span class="w">
</span><span class="n">logmean</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">fit.lnorm</span><span class="o">$</span><span class="n">estimate</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="m">4</span><span class="p">)</span><span class="w">
</span><span class="n">logsd</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">fit.lnorm</span><span class="o">$</span><span class="n">estimate</span><span class="p">[</span><span class="m">2</span><span class="p">],</span><span class="m">4</span><span class="p">)</span><span class="w">
</span><span class="n">yy</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dlnorm</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="w"> </span><span class="n">logmean</span><span class="p">,</span><span class="w"> </span><span class="n">logsd</span><span class="p">)</span><span class="w">
</span><span class="n">LnormDF</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">xx</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="o">=</span><span class="n">yy</span><span class="p">)</span><span class="w">
</span><span class="n">mu</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">mleN</span><span class="o">@</span><span class="n">coef</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">sigma</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">mleN</span><span class="o">@</span><span class="n">coef</span><span class="p">[</span><span class="m">2</span><span class="p">],</span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">lambda</span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">fit.exp</span><span class="o">$</span><span class="n">estimate</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">ExpDF</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">xx</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dexp</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="w"> </span><span class="n">lambda</span><span class="p">))</span><span class="w">
</span><span class="n">GammdaDF</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">xx</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="o">=</span><span class="n">dgamma</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="o">=</span><span class="n">fit.gamma</span><span class="o">$</span><span class="n">estimate</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="n">rate</span><span class="o">=</span><span class="n">fit.gamma</span><span class="o">$</span><span class="n">estimate</span><span class="p">[</span><span class="m">2</span><span class="p">]))</span><span class="w">
</span></code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">C8</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_histogram</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">..density..</span><span class="p">),</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s2">"black"</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="s2">"royalblue"</span><span class="p">,</span><span class="w"> </span><span class="n">bins</span><span class="o">=</span><span class="m">50</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="m">0.4</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">LnormDF</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="o">=</span><span class="s2">"Log-Norm(3.38,0.29)"</span><span class="p">),</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">1.3</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">scale_color_manual</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"forestgreen"</span><span class="p">,</span><span class="s2">"salmon"</span><span class="p">,</span><span class="s2">"gold"</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">"C8 Histogram"</span><span class="p">,</span><span class="w"> </span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"The blue histogram represents the actual distribution"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">theme_light</span><span class="p">()</span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"top"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="w"> </span><span class="n">ExpDF</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="o">=</span><span class="s2">"Exp(0.3)"</span><span class="p">),</span><span class="n">lwd</span><span class="o">=</span><span class="m">1.3</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="w"> </span><span class="n">GammdaDF</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="o">=</span><span class="s2">"Gamma(11,0.35)"</span><span class="p">),</span><span class="n">lwd</span><span class="o">=</span><span class="m">1.3</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/classification-models/README-unnamed-chunk-21-1.png" alt="" /><!-- --></p>

<ul>
  <li>C1:</li>
</ul>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fit.exp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fitdist</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">C1</span><span class="p">,</span><span class="w"> </span><span class="s2">"exp"</span><span class="p">)</span><span class="w">
</span><span class="n">xx</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">15</span><span class="p">)</span><span class="w">
</span><span class="n">yy</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dexp</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="w"> </span><span class="n">fit.exp</span><span class="o">$</span><span class="n">estimate</span><span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="w">
</span><span class="n">expDF</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">xx</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="o">=</span><span class="n">yy</span><span class="p">)</span><span class="w">

</span><span class="n">lambda</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">fit.exp</span><span class="o">$</span><span class="n">estimate</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="m">4</span><span class="p">)</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">C1</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_histogram</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">..density..</span><span class="p">),</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s2">"black"</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="s2">"royalblue"</span><span class="p">,</span><span class="w"> </span><span class="n">bins</span><span class="o">=</span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="m">0.7</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">expDF</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="o">=</span><span class="s2">"Simulated distribution"</span><span class="p">),</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">scale_color_manual</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"salmon2"</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">"C1 Histogram"</span><span class="p">,</span><span class="w"> </span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"The blue histogram represents the actual distribution"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">subtitle</span><span class="o">=</span><span class="w"> </span><span class="n">paste</span><span class="p">(</span><span class="s2">"Simulated distribution ~ Exp ( lambda"</span><span class="p">,</span><span class="n">lambda</span><span class="p">,</span><span class="s2">")"</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">theme_light</span><span class="p">()</span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"top"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/classification-models/README-unnamed-chunk-22-1.png" alt="" /><!-- --></p>

<h2 id="scatterplot-matrix-between-all-the-variables">Scatterplot matrix between all the variables</h2>

<p>Let’s move on and plot a scatter plot matrix between all the independent
variables, according to the disease. This is a very huge image, so I
stored and uploaded it on Github. I suggest to open directly the link to
see the results properly.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">GGally</span><span class="p">)</span><span class="w">
</span><span class="n">ggpairs</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="n">df</span><span class="p">,</span><span class="w">  </span><span class="n">aes</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">disease</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">theme_bw</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/classification-models/README-unnamed-chunk-23-1.png" alt="" /><!-- --></p>

<p>The variables that could be significant are C1, C2, C6,.</p>

<blockquote>
  <h1 id="exercise-2">Exercise 2</h1>

  <p>Perform a classification of the data into the two classes using a
logistic regression model on all the predictors. - Evaluate the output
to identify the most significant predictors. - Evaluate the model
performance in terms of confusion matrix and train/test accuracy. -
Using the fitted model, predict the probability of having the disease
for someone who has C2=31 and all other predictors set to their
average value.</p>
</blockquote>

<h2 id="build-the-training-and-test-sets">Build the training and test sets</h2>

<p>Let’s prepare the training and the test sets. We will use around the 80%
of the data in the training set and the others in the test set. to
extract this 80% we will use generated random numbers and will use them
as index.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span><span class="w">
</span><span class="n">random_number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sample</span><span class="p">(</span><span class="m">392</span><span class="p">,</span><span class="m">92</span><span class="p">)</span><span class="w">
</span><span class="n">training_x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="o">-</span><span class="n">random_number</span><span class="p">,]</span><span class="w">
</span><span class="n">training_y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="o">-</span><span class="n">random_number</span><span class="p">,</span><span class="s2">"disease"</span><span class="p">]</span><span class="w">
</span><span class="n">test_x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="n">random_number</span><span class="p">,]</span><span class="w">
</span><span class="n">test_y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="n">random_number</span><span class="p">,</span><span class="w"> </span><span class="s2">"disease"</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<h2 id="logistic-regression">Logistic Regression</h2>

<p>The first model that we will use is the Logistic Regression. Since it is
a model that is not based upon euclidean distance or some other type of
distances between points we do not perform the standardization of the
variables.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">logit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">glm</span><span class="p">(</span><span class="n">disease</span><span class="o">~</span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="w"> </span><span class="n">training_x</span><span class="p">,</span><span class="w"> </span><span class="n">family</span><span class="o">=</span><span class="n">binomial</span><span class="p">(</span><span class="n">link</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"logit"</span><span class="p">))</span><span class="w">
</span><span class="n">pander</span><span class="p">(</span><span class="n">summary</span><span class="p">(</span><span class="n">logit</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<table>
  <thead>
    <tr>
      <th style="text-align: center"> </th>
      <th style="text-align: center">Estimate</th>
      <th style="text-align: center">Std. Error</th>
      <th style="text-align: center">z value</th>
      <th style="text-align: center">Pr(&gt;|z|)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><strong>(Intercept)</strong></td>
      <td style="text-align: center">-10.7</td>
      <td style="text-align: center">1.477</td>
      <td style="text-align: center">-7.241</td>
      <td style="text-align: center">4.453e-13</td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>C1</strong></td>
      <td style="text-align: center">0.1151</td>
      <td style="text-align: center">0.06671</td>
      <td style="text-align: center">1.725</td>
      <td style="text-align: center">0.08454</td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>C2</strong></td>
      <td style="text-align: center">0.04352</td>
      <td style="text-align: center">0.007019</td>
      <td style="text-align: center">6.201</td>
      <td style="text-align: center">5.604e-10</td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>C3</strong></td>
      <td style="text-align: center">-0.002019</td>
      <td style="text-align: center">0.01422</td>
      <td style="text-align: center">-0.142</td>
      <td style="text-align: center">0.8871</td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>C4</strong></td>
      <td style="text-align: center">0.01853</td>
      <td style="text-align: center">0.02017</td>
      <td style="text-align: center">0.9183</td>
      <td style="text-align: center">0.3584</td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>C5</strong></td>
      <td style="text-align: center">-0.0009058</td>
      <td style="text-align: center">0.001592</td>
      <td style="text-align: center">-0.5691</td>
      <td style="text-align: center">0.5693</td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>C6</strong></td>
      <td style="text-align: center">0.08418</td>
      <td style="text-align: center">0.03269</td>
      <td style="text-align: center">2.575</td>
      <td style="text-align: center">0.01002</td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>C7</strong></td>
      <td style="text-align: center">0.4518</td>
      <td style="text-align: center">0.5324</td>
      <td style="text-align: center">0.8485</td>
      <td style="text-align: center">0.3962</td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>C8</strong></td>
      <td style="text-align: center">0.02081</td>
      <td style="text-align: center">0.0219</td>
      <td style="text-align: center">0.9504</td>
      <td style="text-align: center">0.3419</td>
    </tr>
  </tbody>
</table>

<p>(Dispersion parameter for binomial family taken to be 1 )</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center"> </th>
      <th style="text-align: center"> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">Null deviance:</td>
      <td style="text-align: center">380.5 on 299 degrees of freedom</td>
    </tr>
    <tr>
      <td style="text-align: center">Residual deviance:</td>
      <td style="text-align: center">246.4 on 291 degrees of freedom</td>
    </tr>
  </tbody>
</table>

<p>The variable that is extremely significant is: C2. It has a very low
p-value which represents the possibility to see that data if C2 is not
significant. Also C6 is significant at 1% (usually the threshold is 5%)
and we can consider to use also C1 which has p-value of 8%.</p>

<p>To have a clue if using also C1 we perform the step function which
remove one per time the variable that decrease most the AIC of the model
and stop only when remove another will imply increasing the Akaike
information.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pander</span><span class="p">(</span><span class="n">step</span><span class="p">(</span><span class="n">logit</span><span class="p">,</span><span class="w"> </span><span class="n">trace</span><span class="o">=</span><span class="nb">F</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<table>
  <thead>
    <tr>
      <th style="text-align: center"> </th>
      <th style="text-align: center">Estimate</th>
      <th style="text-align: center">Std. Error</th>
      <th style="text-align: center">z value</th>
      <th style="text-align: center">Pr(&gt;|z|)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><strong>(Intercept)</strong></td>
      <td style="text-align: center">-10.2</td>
      <td style="text-align: center">1.228</td>
      <td style="text-align: center">-8.305</td>
      <td style="text-align: center">1e-16</td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>C1</strong></td>
      <td style="text-align: center">0.1594</td>
      <td style="text-align: center">0.04833</td>
      <td style="text-align: center">3.298</td>
      <td style="text-align: center">0.0009733</td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>C2</strong></td>
      <td style="text-align: center">0.04299</td>
      <td style="text-align: center">0.005953</td>
      <td style="text-align: center">7.221</td>
      <td style="text-align: center">5.157e-13</td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>C6</strong></td>
      <td style="text-align: center">0.1008</td>
      <td style="text-align: center">0.02526</td>
      <td style="text-align: center">3.992</td>
      <td style="text-align: center">6.551e-05</td>
    </tr>
  </tbody>
</table>

<p>Fitting generalized (binomial/logit) linear model: disease ~ C1 + C2 +
C6</p>

<p>The function returns us the model including also C1. So we decide to use
this model with C1,C2,C6. We’ve also tried if there are some
interactions between them but the results were negative.</p>

<h2 id="3d-representation-of-the-data">3D representation of the data</h2>

<p>Since we have only three variables we can plot them and see if we can
find a clear pattern inside the data that can help us to understand
properly how the data are distributed in relation to the dependent
variable that we are trying to understand:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">plotly</span><span class="p">)</span><span class="w">
</span><span class="n">fig</span><span class="o">&lt;-</span><span class="w"> </span><span class="n">plot_ly</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df</span><span class="o">$</span><span class="n">C1</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">df</span><span class="o">$</span><span class="n">C2</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="o">=</span><span class="n">df</span><span class="o">$</span><span class="n">C6</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"scatter3d"</span><span class="p">,</span><span class="w"> </span><span class="n">mode</span><span class="o">=</span><span class="s2">"markers"</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="n">df</span><span class="o">$</span><span class="n">disease</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">colors</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"firebrick"</span><span class="p">,</span><span class="s2">"royalblue"</span><span class="p">))</span><span class="w">
</span><span class="n">fig</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fig</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">layout</span><span class="p">(</span><span class="w">
    </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Representation 3d of the our predictors colored by the target"</span><span class="p">,</span><span class="w">
    </span><span class="n">scene</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="w">
      </span><span class="n">xaxis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"C1"</span><span class="p">),</span><span class="w">
      </span><span class="n">yaxis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"C2"</span><span class="p">),</span><span class="w">
      </span><span class="n">zaxis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"C6"</span><span class="p">)))</span><span class="w">
</span><span class="c1"># since is a pdf here there is the snapshot of the interactive 3d graph:</span><span class="w">
</span><span class="n">fig</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/classification-models/README-unnamed-chunk-27-1.png" alt="" /><!-- --></p>

<p>From this graph we can say straightforwardly that there isn’t a clear
division between the “Y” response and the “N” response. This will make
the work harder.</p>

<p>So let’s perform the logistic regression with C1,C2 and C6:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">logit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">glm</span><span class="p">(</span><span class="n">disease</span><span class="o">~</span><span class="n">C1</span><span class="o">+</span><span class="n">C2</span><span class="o">+</span><span class="n">C6</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="w"> </span><span class="n">training_x</span><span class="p">,</span><span class="w"> </span><span class="n">family</span><span class="o">=</span><span class="n">binomial</span><span class="p">(</span><span class="n">link</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"logit"</span><span class="p">))</span><span class="w">
</span><span class="n">pander</span><span class="p">(</span><span class="n">summary</span><span class="p">(</span><span class="n">logit</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<table>
  <thead>
    <tr>
      <th style="text-align: center"> </th>
      <th style="text-align: center">Estimate</th>
      <th style="text-align: center">Std. Error</th>
      <th style="text-align: center">z value</th>
      <th style="text-align: center">Pr(&gt;|z|)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><strong>(Intercept)</strong></td>
      <td style="text-align: center">-10.2</td>
      <td style="text-align: center">1.228</td>
      <td style="text-align: center">-8.305</td>
      <td style="text-align: center">1e-16</td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>C1</strong></td>
      <td style="text-align: center">0.1594</td>
      <td style="text-align: center">0.04833</td>
      <td style="text-align: center">3.298</td>
      <td style="text-align: center">0.0009733</td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>C2</strong></td>
      <td style="text-align: center">0.04299</td>
      <td style="text-align: center">0.005953</td>
      <td style="text-align: center">7.221</td>
      <td style="text-align: center">5.157e-13</td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>C6</strong></td>
      <td style="text-align: center">0.1008</td>
      <td style="text-align: center">0.02526</td>
      <td style="text-align: center">3.992</td>
      <td style="text-align: center">6.551e-05</td>
    </tr>
  </tbody>
</table>

<p>(Dispersion parameter for binomial family taken to be 1 )</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center"> </th>
      <th style="text-align: center"> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">Null deviance:</td>
      <td style="text-align: center">380.5 on 299 degrees of freedom</td>
    </tr>
    <tr>
      <td style="text-align: center">Residual deviance:</td>
      <td style="text-align: center">250.0 on 296 degrees of freedom</td>
    </tr>
  </tbody>
</table>

<p>Let’s evaluate the performance of the logistic regression in therms of
confusion matrix score over the test set and the training set. We make a
prediction over our training set and then we label the result having a
cutoff equal to 0.5. After that we will repeat the same operation for
the test set.</p>

<h2 id="confusion-matrix">Confusion matrix</h2>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">broom</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">cvms</span><span class="p">)</span><span class="w">
</span><span class="n">training_prediction_prob</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">logit</span><span class="p">,</span><span class="w"> </span><span class="n">training_x</span><span class="p">,</span><span class="n">type</span><span class="o">=</span><span class="s2">"response"</span><span class="p">)</span><span class="w">
</span><span class="n">training_prediction_labelled</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ifelse</span><span class="p">(</span><span class="n">training_prediction_prob</span><span class="o">&gt;</span><span class="m">0.5</span><span class="p">,</span><span class="s2">"Y"</span><span class="p">,</span><span class="s2">"N"</span><span class="p">)</span><span class="w">
</span><span class="n">cfm</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">broom</span><span class="o">::</span><span class="n">tidy</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">training_prediction_labelled</span><span class="p">,</span><span class="w"> </span><span class="n">training_y</span><span class="p">))</span><span class="w">
</span><span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">cfm</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">target_col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"training_y"</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">prediction_col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"training_prediction_labelled"</span><span class="p">,</span><span class="w">
                      </span><span class="n">counts_col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"n"</span><span class="p">,</span><span class="w">
                      </span><span class="n">darkness</span><span class="w"> </span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w">
                      </span><span class="n">class_order</span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Y"</span><span class="p">,</span><span class="s2">"N"</span><span class="p">),</span><span class="w">
                      </span><span class="n">theme_fn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ggplot2</span><span class="o">::</span><span class="n">theme_dark</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/classification-models/README-unnamed-chunk-29-1.png" alt="" /><!-- --></p>

<p>Even if the true positive rate, the true negative rate and others
information are reported on the table we want to explicit those:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">logit_tp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">table</span><span class="p">(</span><span class="n">training_prediction_labelled</span><span class="p">,</span><span class="w"> </span><span class="n">training_y</span><span class="p">)[</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">]</span><span class="o">/</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">training_prediction_labelled</span><span class="p">,</span><span class="w"> </span><span class="n">training_y</span><span class="p">)[,</span><span class="m">2</span><span class="p">])</span><span class="w">
</span><span class="n">logit_tn</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">table</span><span class="p">(</span><span class="n">training_prediction_labelled</span><span class="p">,</span><span class="w"> </span><span class="n">training_y</span><span class="p">)[</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">]</span><span class="o">/</span><span class="nf">sum</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">training_prediction_labelled</span><span class="p">,</span><span class="w"> </span><span class="n">training_y</span><span class="p">)[,</span><span class="m">1</span><span class="p">])</span><span class="w">
</span><span class="n">logit_accuracy</span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">training_prediction_labelled</span><span class="o">==</span><span class="n">training_y</span><span class="p">)</span><span class="w">
</span><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"accuracy logit on training set:"</span><span class="p">,</span><span class="n">logit_accuracy</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "accuracy logit on training set: 0.806666666666667"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"true positive rate on training set::"</span><span class="p">,</span><span class="w"> </span><span class="n">logit_tp</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "true positive rate on training set:: 0.636363636363636"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"true negative rate on training set::"</span><span class="p">,</span><span class="w"> </span><span class="n">logit_tn</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "true negative rate on training set:: 0.890547263681592"
</code></pre></div></div>

<p>Now we perform the same operation on the test set:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test_prediction_prob</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">logit</span><span class="p">,</span><span class="w"> </span><span class="n">test_x</span><span class="p">,</span><span class="n">type</span><span class="o">=</span><span class="s2">"response"</span><span class="p">)</span><span class="w">
</span><span class="c1"># contrasts(df$disease) # 0:not-disease ; 1: disease</span><span class="w">
</span><span class="n">test_prediction_labelled</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ifelse</span><span class="p">(</span><span class="n">test_prediction_prob</span><span class="o">&gt;</span><span class="m">0.5</span><span class="p">,</span><span class="s2">"Y"</span><span class="p">,</span><span class="s2">"N"</span><span class="p">)</span><span class="w">
</span><span class="n">cfm</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">broom</span><span class="o">::</span><span class="n">tidy</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">test_prediction_labelled</span><span class="p">,</span><span class="w"> </span><span class="n">test_y</span><span class="p">))</span><span class="w">
</span><span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">cfm</span><span class="p">,</span><span class="w"> </span><span class="n">target_col</span><span class="o">=</span><span class="s2">"test_y"</span><span class="p">,</span><span class="w"> </span><span class="n">prediction_col</span><span class="o">=</span><span class="s2">"test_prediction_labelled"</span><span class="p">,</span><span class="w">
  </span><span class="n">counts_col</span><span class="o">=</span><span class="s2">"n"</span><span class="p">,</span><span class="w"> </span><span class="n">darkness</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">class_order</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"Y"</span><span class="p">,</span><span class="s2">"N"</span><span class="p">),</span><span class="w"> </span><span class="n">theme_fn</span><span class="o">=</span><span class="n">ggplot2</span><span class="o">::</span><span class="n">theme_dark</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/classification-models/README-unnamed-chunk-31-1.png" alt="" /><!-- --></p>

<p>As we did before we explicitly extract the tpr, the fnr and the
accuracy:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">logit_tp_test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">table</span><span class="p">(</span><span class="n">test_prediction_labelled</span><span class="p">,</span><span class="w"> </span><span class="n">test_y</span><span class="p">)[</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">]</span><span class="o">/</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">test_prediction_labelled</span><span class="p">,</span><span class="w"> </span><span class="n">test_y</span><span class="p">)[,</span><span class="m">2</span><span class="p">])</span><span class="w">
</span><span class="n">logit_tn_test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">table</span><span class="p">(</span><span class="n">test_prediction_labelled</span><span class="p">,</span><span class="w"> </span><span class="n">test_y</span><span class="p">)[</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">]</span><span class="o">/</span><span class="nf">sum</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">test_prediction_labelled</span><span class="p">,</span><span class="w"> </span><span class="n">test_y</span><span class="p">)[,</span><span class="m">1</span><span class="p">])</span><span class="w">
</span><span class="n">accuracy_logit</span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">test_prediction_labelled</span><span class="o">==</span><span class="n">test_y</span><span class="p">)</span><span class="w">
</span><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"accuracy on test_set:"</span><span class="p">,</span><span class="n">accuracy_logit</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "accuracy on test_set: 0.706521739130435"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"true positive rate on test_set:"</span><span class="p">,</span><span class="w"> </span><span class="n">logit_tp_test</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "true positive rate on test_set: 0.451612903225806"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"true negative rate on test_set:"</span><span class="p">,</span><span class="w"> </span><span class="n">logit_tn_test</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "true negative rate on test_set: 0.836065573770492"
</code></pre></div></div>

<h2 id="predict-new-observation">Predict new observation</h2>

<p>From what we can see the model predicts quit well about the negative
case but performs very poorly when the response is “Y”. Moreover we did
not try to predict some cases in which our model has never seen before
similar data as:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">new_obs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">C1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">C1</span><span class="p">),</span><span class="w"> </span><span class="n">C2</span><span class="o">=</span><span class="m">31</span><span class="p">,</span><span class="w"> </span><span class="n">C6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">df</span><span class="o">$</span><span class="n">C6</span><span class="p">))</span><span class="w">
</span><span class="c1"># C2=31 none of the training data was similar to this. </span><span class="w">
</span><span class="n">new_obs_prediction</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">logit</span><span class="p">,</span><span class="w"> </span><span class="n">new_obs</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"response"</span><span class="p">)</span><span class="w">
</span><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"the probability that the new observation is 'Y' is equl to:"</span><span class="p">,</span><span class="w"> </span><span class="n">new_obs_prediction</span><span class="w"> </span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "the probability that the new observation is 'Y' is equl to: 0.00667738038457288"
</code></pre></div></div>

<blockquote>
  <h1 id="exercise-3">Exercise 3</h1>

  <p>Perform a classification via a k-nn model using all of the available
variables and exploring different values of k; - Discuss the results
and reach a conclusion on the optimal value for k.</p>
</blockquote>

<h2 id="k-nearest-neighbor">K-Nearest Neighbor</h2>

<p>Let’s use a different model as the k-nearest neighbor and try to predict
better our target variable. Taking in count that k-nn works with
distances we will perform a standardization of our variables.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">class</span><span class="p">)</span><span class="w">
</span><span class="n">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span><span class="w">
</span><span class="n">random_number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sample</span><span class="p">(</span><span class="m">392</span><span class="p">,</span><span class="m">92</span><span class="p">)</span><span class="w">

</span><span class="n">train_x_st</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">scale</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="o">-</span><span class="n">random_number</span><span class="p">,</span><span class="w"> </span><span class="m">-9</span><span class="p">])</span><span class="w">
</span><span class="n">train_y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="o">-</span><span class="n">random_number</span><span class="p">,</span><span class="m">9</span><span class="p">]</span><span class="w">

</span><span class="n">test_x_st</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">scale</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">random_number</span><span class="p">,</span><span class="w"> </span><span class="m">-9</span><span class="p">])</span><span class="w">
</span><span class="n">test_y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="n">random_number</span><span class="p">,</span><span class="w"> </span><span class="m">9</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<h2 id="perform-the-model-with-multiple-k">Perform the model with multiple K</h2>

<p>Knowing that the choice of K is very significant we will perform the
same operation with many different k to see which one has the best trade
off between train and test error rate:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">training_error</span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">()</span><span class="w">
</span><span class="n">test_error</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">()</span><span class="w">
</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">100</span><span class="p">){</span><span class="w">
  </span><span class="n">k1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">knn</span><span class="p">(</span><span class="n">train_x_st</span><span class="p">,</span><span class="w"> </span><span class="n">train_x_st</span><span class="p">,</span><span class="w"> </span><span class="n">train_y</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="n">i</span><span class="p">)</span><span class="w">
  </span><span class="n">k2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">knn</span><span class="p">(</span><span class="n">train_x_st</span><span class="p">,</span><span class="n">test_x_st</span><span class="p">,</span><span class="w"> </span><span class="n">train_y</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="n">i</span><span class="w"> </span><span class="p">)</span><span class="w">
  </span><span class="n">training_error</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">append</span><span class="p">(</span><span class="n">training_error</span><span class="p">,(</span><span class="n">mean</span><span class="p">(</span><span class="n">k1</span><span class="o">!=</span><span class="n">train_y</span><span class="p">)))</span><span class="w">
  </span><span class="n">test_error</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">append</span><span class="p">(</span><span class="n">test_error</span><span class="p">,(</span><span class="n">mean</span><span class="p">(</span><span class="n">k2</span><span class="o">!=</span><span class="n">test_y</span><span class="p">)))}</span><span class="w">
</span></code></pre></div></div>

<h2 id="plot-the-the-error-rate-over-k">Plot the the error rate over K</h2>

<p>Let’s plot the training error rate and the test error rate according to
the number of K used to make the prediction in order to be able to
choice the best one.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">error_rate</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">train_e</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">training_error</span><span class="p">,</span><span class="w"> </span><span class="n">test_e</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">test_error</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">&lt;-</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">100</span><span class="p">))</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error_rate</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">train_e</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Train Error Rate"</span><span class="p">),</span><span class="n">lwd</span><span class="o">=</span><span class="m">1.2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">train_e</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s2">"salmon2"</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="o">=</span><span class="m">19</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">test_e</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Test Error Rate"</span><span class="p">),</span><span class="n">lwd</span><span class="o">=</span><span class="m">1.2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">test_e</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s2">"royalblue3"</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="o">=</span><span class="m">19</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">scale_colour_manual</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Train Error Rate"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Test Error Rate"</span><span class="p">),</span><span class="w">
                      </span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"salmon1"</span><span class="p">,</span><span class="s2">"royalblue2"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"Numbers ok K neighbours"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"Train and test error rate"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">"Train Error and Test Error ~ K"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="o">=</span><span class="s2">"top"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/classification-models/README-unnamed-chunk-36-1.png" alt="" /><!-- --></p>

<p>Looking at the result seems that the best trade off could be around 30
or around 6. Looking at the fact that the model after k = 30 seems
converge I will choose 31 as k so to also keep the model quit simple.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">error_rate</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">train_e</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">training_error</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">35</span><span class="p">],</span><span class="w"> </span><span class="n">test_e</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">test_error</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">35</span><span class="p">],</span><span class="w"> </span><span class="n">k</span><span class="o">&lt;-</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">35</span><span class="p">))</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error_rate</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">k</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">train_e</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Train Error Rate"</span><span class="p">),</span><span class="n">lwd</span><span class="o">=</span><span class="m">1.2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">train_e</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s2">"salmon2"</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="o">=</span><span class="m">19</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">test_e</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Test Error Rate"</span><span class="p">),</span><span class="n">lwd</span><span class="o">=</span><span class="m">1.2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">test_e</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s2">"royalblue3"</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="o">=</span><span class="m">19</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"Numbers ok K neighbours"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"Train and test error rate"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">"Train Error and Test Error ~ K"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="o">=</span><span class="s2">"top"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_vline</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="m">31</span><span class="p">,</span><span class="n">colour</span><span class="o">=</span><span class="s2">"K=31"</span><span class="p">),</span><span class="w"> </span><span class="n">linetype</span><span class="o">=</span><span class="s2">"dashed"</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_vline</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="m">6</span><span class="p">,</span><span class="n">colour</span><span class="o">=</span><span class="s2">"K=6"</span><span class="p">),</span><span class="w"> </span><span class="n">linetype</span><span class="o">=</span><span class="s2">"dashed"</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">scale_colour_manual</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Train Error Rate"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Test Error Rate"</span><span class="p">,</span><span class="w"> </span><span class="s2">"K=31"</span><span class="p">,</span><span class="s2">"K=6"</span><span class="p">),</span><span class="w">
                      </span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"salmon1"</span><span class="p">,</span><span class="s2">"royalblue2"</span><span class="p">,</span><span class="s2">"red"</span><span class="p">,</span><span class="s2">"gold"</span><span class="p">))</span><span class="w"> 
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/classification-models/README-unnamed-chunk-37-1.png" alt="" /><!-- --></p>

<h2 id="confusion-matrix-1">Confusion matrix</h2>

<p>Let’s conclude this part on k-nn plotting the confusion matrix obtained
using k = 31:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">knn_pred</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">knn</span><span class="p">(</span><span class="n">train_x_st</span><span class="p">,</span><span class="w"> </span><span class="n">test_x_st</span><span class="p">,</span><span class="w"> </span><span class="n">train_y</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="m">31</span><span class="p">,</span><span class="w"> </span><span class="n">prob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">)</span><span class="w">
</span><span class="n">knn_tp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">table</span><span class="p">(</span><span class="n">knn_pred</span><span class="p">,</span><span class="w"> </span><span class="n">test_y</span><span class="p">)[</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">]</span><span class="o">/</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">knn_pred</span><span class="p">,</span><span class="w"> </span><span class="n">test_y</span><span class="p">)[,</span><span class="m">2</span><span class="p">])</span><span class="w">
</span><span class="n">knn_tn</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">table</span><span class="p">(</span><span class="n">knn_pred</span><span class="p">,</span><span class="w"> </span><span class="n">test_y</span><span class="p">)[</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">]</span><span class="o">/</span><span class="nf">sum</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">knn_pred</span><span class="p">,</span><span class="w"> </span><span class="n">test_y</span><span class="p">)[,</span><span class="m">1</span><span class="p">])</span><span class="w">
</span><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"Accuracy with k=31 :"</span><span class="p">,(</span><span class="n">mean</span><span class="p">(</span><span class="n">knn_pred</span><span class="o">==</span><span class="n">test_y</span><span class="p">))))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "Accuracy with k=31 : 0.760869565217391"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"true positive rate:"</span><span class="p">,</span><span class="w"> </span><span class="n">knn_tp</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "true positive rate: 0.451612903225806"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"true negative rate:"</span><span class="p">,</span><span class="w"> </span><span class="n">knn_tn</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "true negative rate: 0.918032786885246"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">knn_pred</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">knn</span><span class="p">(</span><span class="n">train_x_st</span><span class="p">,</span><span class="w"> </span><span class="n">test_x_st</span><span class="p">,</span><span class="w"> </span><span class="n">train_y</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="m">31</span><span class="p">)</span><span class="w">
</span><span class="n">cfm</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">broom</span><span class="o">::</span><span class="n">tidy</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">knn_pred</span><span class="p">,</span><span class="w"> </span><span class="n">test_y</span><span class="p">))</span><span class="w">
</span><span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">cfm</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">target_col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"test_y"</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">prediction_col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"knn_pred"</span><span class="p">,</span><span class="w">
                      </span><span class="n">counts_col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"n"</span><span class="p">,</span><span class="w">
                      </span><span class="n">darkness</span><span class="w"> </span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w">
                      </span><span class="n">class_order</span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Y"</span><span class="p">,</span><span class="s2">"N"</span><span class="p">),</span><span class="w">
                      </span><span class="n">theme_fn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ggplot2</span><span class="o">::</span><span class="n">theme_dark</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/classification-models/README-unnamed-chunk-39-1.png" alt="" /><!-- --></p>

<p>It seems that our model has problems again to predict the response when
the target is “Y”.</p>

<blockquote>
  <h1 id="exercise-4">Exercise 4</h1>
</blockquote>

<blockquote>
  <p>Explore the use of LDA, QDA, and Naive Bayes to predict disease onset
using all the predictors. For each method: - Train the model on the
training data - Apply the fitted model to the test set; compute the
confusion matrix and prediction accuracy</p>
</blockquote>

<h2 id="lda">LDA</h2>

<p>Since it is not a model based upon distances between points we do not
perform the standardization of the variables.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span><span class="w">
</span><span class="n">random_number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sample</span><span class="p">(</span><span class="m">392</span><span class="p">,</span><span class="m">92</span><span class="p">)</span><span class="w">
</span><span class="n">train_x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="o">-</span><span class="n">random_number</span><span class="p">,]</span><span class="w">
</span><span class="n">train_y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="o">-</span><span class="n">random_number</span><span class="p">,</span><span class="m">9</span><span class="p">]</span><span class="w">
</span><span class="n">test_x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="n">random_number</span><span class="p">,]</span><span class="w">
</span><span class="n">test_y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="n">random_number</span><span class="p">,</span><span class="m">9</span><span class="p">]</span><span class="w">

</span><span class="n">LDA</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lda</span><span class="p">(</span><span class="n">disease</span><span class="o">~</span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="w"> </span><span class="n">train_x</span><span class="p">)</span><span class="w">
</span><span class="n">lda_prediction</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">LDA</span><span class="p">,</span><span class="w"> </span><span class="n">test_x</span><span class="p">)</span><span class="w">

</span><span class="n">lda_tp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">table</span><span class="p">(</span><span class="n">lda_prediction</span><span class="o">$</span><span class="n">class</span><span class="p">,</span><span class="w"> </span><span class="n">test_y</span><span class="p">)[</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">]</span><span class="o">/</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">lda_prediction</span><span class="o">$</span><span class="n">class</span><span class="p">,</span><span class="w"> </span><span class="n">test_y</span><span class="p">)[,</span><span class="m">2</span><span class="p">])</span><span class="w">
</span><span class="n">lda_tn</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">table</span><span class="p">(</span><span class="n">lda_prediction</span><span class="o">$</span><span class="n">class</span><span class="p">,</span><span class="w"> </span><span class="n">test_y</span><span class="p">)[</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">]</span><span class="o">/</span><span class="nf">sum</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">lda_prediction</span><span class="o">$</span><span class="n">class</span><span class="p">,</span><span class="w"> </span><span class="n">test_y</span><span class="p">)[,</span><span class="m">1</span><span class="p">])</span><span class="w">
</span><span class="n">lda_accuracy</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">lda_prediction</span><span class="o">$</span><span class="n">class</span><span class="o">==</span><span class="n">test_y</span><span class="p">)</span><span class="w">

</span><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"Accuracy of LDA:"</span><span class="p">,</span><span class="w"> </span><span class="n">lda_accuracy</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "Accuracy of LDA: 0.706521739130435"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"true positive rate:"</span><span class="p">,</span><span class="w"> </span><span class="n">lda_tp</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "true positive rate: 0.451612903225806"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"true negative rate:"</span><span class="p">,</span><span class="w"> </span><span class="n">lda_tn</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "true negative rate: 0.836065573770492"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">labeled</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lda_prediction</span><span class="o">$</span><span class="n">class</span><span class="w">
</span><span class="n">cfm</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">broom</span><span class="o">::</span><span class="n">tidy</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">labeled</span><span class="p">,</span><span class="w"> </span><span class="n">test_y</span><span class="p">))</span><span class="w">
</span><span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">cfm</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">target_col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"test_y"</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">prediction_col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"labeled"</span><span class="p">,</span><span class="w">
                      </span><span class="n">counts_col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"n"</span><span class="p">,</span><span class="w">
                      </span><span class="n">darkness</span><span class="w"> </span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w">
                      </span><span class="n">class_order</span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Y"</span><span class="p">,</span><span class="s2">"N"</span><span class="p">),</span><span class="w">
                      </span><span class="n">theme_fn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ggplot2</span><span class="o">::</span><span class="n">theme_dark</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/classification-models/README-unnamed-chunk-41-1.png" alt="" /><!-- -->
As the models before it performs quiet poorly.</p>

<h2 id="qda">QDA</h2>

<p>Since it is not a model based upon distances between points we do not
perform the standardization of the variables.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span><span class="w">
</span><span class="n">random_number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sample</span><span class="p">(</span><span class="m">392</span><span class="p">,</span><span class="m">92</span><span class="p">)</span><span class="w">
</span><span class="n">train_x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="o">-</span><span class="n">random_number</span><span class="p">,]</span><span class="w">
</span><span class="n">train_y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="o">-</span><span class="n">random_number</span><span class="p">,</span><span class="m">9</span><span class="p">]</span><span class="w">
</span><span class="n">test_x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="n">random_number</span><span class="p">,]</span><span class="w">
</span><span class="n">test_y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="n">random_number</span><span class="p">,</span><span class="m">9</span><span class="p">]</span><span class="w">

</span><span class="n">QDA</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">qda</span><span class="p">(</span><span class="n">disease</span><span class="o">~</span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="w"> </span><span class="n">train_x</span><span class="p">)</span><span class="w">
</span><span class="n">qda_prediction</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">QDA</span><span class="p">,</span><span class="w"> </span><span class="n">test_x</span><span class="p">)</span><span class="w">

</span><span class="n">qda_tp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">table</span><span class="p">(</span><span class="n">qda_prediction</span><span class="o">$</span><span class="n">class</span><span class="p">,</span><span class="w"> </span><span class="n">test_y</span><span class="p">)[</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">]</span><span class="o">/</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">qda_prediction</span><span class="o">$</span><span class="n">class</span><span class="p">,</span><span class="w"> </span><span class="n">test_y</span><span class="p">)[,</span><span class="m">2</span><span class="p">])</span><span class="w">
</span><span class="n">qda_tn</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">table</span><span class="p">(</span><span class="n">qda_prediction</span><span class="o">$</span><span class="n">class</span><span class="p">,</span><span class="w"> </span><span class="n">test_y</span><span class="p">)[</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">]</span><span class="o">/</span><span class="nf">sum</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">qda_prediction</span><span class="o">$</span><span class="n">class</span><span class="p">,</span><span class="w"> </span><span class="n">test_y</span><span class="p">)[,</span><span class="m">1</span><span class="p">])</span><span class="w">
</span><span class="n">qda_accuracy</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">qda_prediction</span><span class="o">$</span><span class="n">class</span><span class="o">==</span><span class="n">test_y</span><span class="p">)</span><span class="w">

</span><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"Accuracy of QDA:"</span><span class="p">,</span><span class="w"> </span><span class="n">qda_accuracy</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "Accuracy of QDA: 0.717391304347826"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"true positive rate:"</span><span class="p">,</span><span class="w"> </span><span class="n">qda_tp</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "true positive rate: 0.451612903225806"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"true negative rate:"</span><span class="p">,</span><span class="w"> </span><span class="n">qda_tn</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "true negative rate: 0.852459016393443"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">labeled</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">qda_prediction</span><span class="o">$</span><span class="n">class</span><span class="w">
</span><span class="n">cfm</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">broom</span><span class="o">::</span><span class="n">tidy</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">labeled</span><span class="p">,</span><span class="w"> </span><span class="n">test_y</span><span class="p">))</span><span class="w">
</span><span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">cfm</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">target_col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"test_y"</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">prediction_col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"labeled"</span><span class="p">,</span><span class="w">
                      </span><span class="n">counts_col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"n"</span><span class="p">,</span><span class="w">
                      </span><span class="n">darkness</span><span class="w"> </span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w">
                      </span><span class="n">class_order</span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Y"</span><span class="p">,</span><span class="s2">"N"</span><span class="p">),</span><span class="w">
                      </span><span class="n">theme_fn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ggplot2</span><span class="o">::</span><span class="n">theme_dark</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/classification-models/README-unnamed-chunk-43-1.png" alt="" /><!-- --></p>

<p>Qda compared to Lda predicts slightly better the negative cases but
returns the same bad result predicting the positive cases.</p>

<h2 id="naive-bayes-classifier">Naive Bayes Classifier</h2>

<p>Since it is not a model based upon distances between points we do not
perform the standardization of the variables.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">e1071</span><span class="p">)</span><span class="w">
</span><span class="n">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span><span class="w">
</span><span class="n">random_number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sample</span><span class="p">(</span><span class="m">392</span><span class="p">,</span><span class="m">92</span><span class="p">)</span><span class="w">
</span><span class="n">train_x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="o">-</span><span class="n">random_number</span><span class="p">,]</span><span class="w">
</span><span class="n">train_y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="o">-</span><span class="n">random_number</span><span class="p">,</span><span class="m">9</span><span class="p">]</span><span class="w">
</span><span class="n">test_x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="n">random_number</span><span class="p">,]</span><span class="w">
</span><span class="n">test_y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="n">random_number</span><span class="p">,</span><span class="m">9</span><span class="p">]</span><span class="w">

</span><span class="n">NB</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">naiveBayes</span><span class="p">(</span><span class="n">disease</span><span class="o">~</span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">train_x</span><span class="p">,</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">NB_prediction</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">NB</span><span class="p">,</span><span class="w"> </span><span class="n">test_x</span><span class="p">)</span><span class="w">
</span><span class="n">NB_prediction_for_ROC</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">NB</span><span class="p">,</span><span class="w"> </span><span class="n">test_x</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"raw"</span><span class="p">)</span><span class="w">

</span><span class="n">nb_tp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">table</span><span class="p">(</span><span class="n">NB_prediction</span><span class="p">,</span><span class="w"> </span><span class="n">test_y</span><span class="p">)[</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">]</span><span class="o">/</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">NB_prediction</span><span class="p">,</span><span class="w"> </span><span class="n">test_y</span><span class="p">)[,</span><span class="m">2</span><span class="p">])</span><span class="w">
</span><span class="n">nb_tn</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">table</span><span class="p">(</span><span class="n">NB_prediction</span><span class="p">,</span><span class="w"> </span><span class="n">test_y</span><span class="p">)[</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">]</span><span class="o">/</span><span class="nf">sum</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">NB_prediction</span><span class="p">,</span><span class="w"> </span><span class="n">test_y</span><span class="p">)[,</span><span class="m">1</span><span class="p">])</span><span class="w">

</span><span class="n">nb_accuracy</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">NB_prediction</span><span class="o">==</span><span class="n">test_y</span><span class="p">)</span><span class="w">

</span><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"Accuracy of Naive Bayes Classifier:"</span><span class="p">,</span><span class="n">nb_accuracy</span><span class="w"> </span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "Accuracy of Naive Bayes Classifier: 0.739130434782609"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"true positive rate:"</span><span class="p">,</span><span class="w"> </span><span class="n">nb_tp</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "true positive rate: 0.548387096774194"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"true negative rate:"</span><span class="p">,</span><span class="w"> </span><span class="n">nb_tn</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "true negative rate: 0.836065573770492"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cfm</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">broom</span><span class="o">::</span><span class="n">tidy</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">NB_prediction</span><span class="p">,</span><span class="w"> </span><span class="n">test_y</span><span class="p">))</span><span class="w">
</span><span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">cfm</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">target_col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"test_y"</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">prediction_col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"NB_prediction"</span><span class="p">,</span><span class="w">
                      </span><span class="n">counts_col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"n"</span><span class="p">,</span><span class="w">
                      </span><span class="n">darkness</span><span class="w"> </span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w">
                      </span><span class="n">class_order</span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Y"</span><span class="p">,</span><span class="s2">"N"</span><span class="p">),</span><span class="w">
                      </span><span class="n">theme_fn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ggplot2</span><span class="o">::</span><span class="n">theme_dark</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/classification-models/README-unnamed-chunk-45-1.png" alt="" /><!-- --></p>

<p>Naive Bayes Classifier seems that performs slightly better. It has a
true positive rate equal to 54.8%, which is again too small.</p>

<h1 id="exercise-5">Exercise 5</h1>

<p>Since all the models perform almost equal, except for the naive bayes
which has a slightly better true positive rate, we will try to change
the cut-off of our prediction and see the results in order to understand
if there is a better mode.</p>

<h2 id="comparing-the-performance-of-the-models">Comparing the performance of the models</h2>

<p>Compare all the methods considered so far on the test data (logistic
regression, k-nn, LDA, QDA, NB). Check again the accuracy of each model
and the true positive and the true negative rate:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"accuracy logit:"</span><span class="p">,</span><span class="n">accuracy_logit</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "accuracy logit: 0.706521739130435"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"true positive rate:"</span><span class="p">,</span><span class="w"> </span><span class="n">logit_tp</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "true positive rate: 0.636363636363636"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"true negative rate:"</span><span class="p">,</span><span class="w"> </span><span class="n">logit_tn</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "true negative rate: 0.890547263681592"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"Accuracy with k=31 :"</span><span class="p">,(</span><span class="n">mean</span><span class="p">(</span><span class="n">knn_pred</span><span class="o">==</span><span class="n">test_y</span><span class="p">))))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "Accuracy with k=31 : 0.760869565217391"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"true positive rate:"</span><span class="p">,</span><span class="w"> </span><span class="n">knn_tp</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "true positive rate: 0.451612903225806"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"true negative rate:"</span><span class="p">,</span><span class="w"> </span><span class="n">knn_tn</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "true negative rate: 0.918032786885246"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"Accuracy of LDA:"</span><span class="p">,</span><span class="w"> </span><span class="n">lda_accuracy</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "Accuracy of LDA: 0.706521739130435"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"true positive rate:"</span><span class="p">,</span><span class="w"> </span><span class="n">lda_tp</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "true positive rate: 0.451612903225806"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"true negative rate:"</span><span class="p">,</span><span class="w"> </span><span class="n">lda_tn</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "true negative rate: 0.836065573770492"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"Accuracy of QDA:"</span><span class="p">,</span><span class="w"> </span><span class="n">qda_accuracy</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "Accuracy of QDA: 0.717391304347826"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"true positive rate:"</span><span class="p">,</span><span class="w"> </span><span class="n">qda_tp</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "true positive rate: 0.451612903225806"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"true negative rate:"</span><span class="p">,</span><span class="w"> </span><span class="n">qda_tn</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "true negative rate: 0.852459016393443"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"Accuracy of Naive Bayes Classifier:"</span><span class="p">,</span><span class="n">nb_accuracy</span><span class="w"> </span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "Accuracy of Naive Bayes Classifier: 0.739130434782609"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"true positive rate:"</span><span class="p">,</span><span class="w"> </span><span class="n">nb_tp</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "true positive rate: 0.548387096774194"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"true negative rate:"</span><span class="p">,</span><span class="w"> </span><span class="n">nb_tn</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "true negative rate: 0.836065573770492"
</code></pre></div></div>

<h2 id="roc-curve">ROC Curve</h2>

<p>Draw the ROC curve, combining all of the ROC curves in a single plot.
Compute also the AUC for each method. Discuss whether there is any
method clearly outperforming the rest:</p>

<p>So the models seems similar between them. Since the class is unbalanced
let’s try to plot the ROC curves of the models and calculate the
respectively AUC.</p>

<p>It tooks a while to understood how the function knn return the
probabilities: basically the probabilities that coming back are the ones
associated to each label assigned. So to transform that I do a loop over
all the array and for each “N” I assign 1-p so all the probabilities
that we have are referred to “Y”.</p>

<h2 id="obtaining-the-probabilities-for-the-knn-model">Obtaining the probabilities for the knn model</h2>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">labe</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">knn</span><span class="p">(</span><span class="n">train_x_st</span><span class="p">,</span><span class="w"> </span><span class="n">test_x_st</span><span class="p">,</span><span class="w"> </span><span class="n">train_y</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="o">=</span><span class="m">31</span><span class="p">,</span><span class="w"> </span><span class="n">prob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">)</span><span class="w">
</span><span class="n">prob</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">attr</span><span class="p">(</span><span class="n">labe</span><span class="p">,</span><span class="n">which</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"prob"</span><span class="p">)</span><span class="w">
</span><span class="n">dt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">labe</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="o">=</span><span class="n">prob</span><span class="p">)</span><span class="w">
</span><span class="n">dt</span><span class="o">$</span><span class="n">reverse</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ifelse</span><span class="p">(</span><span class="n">dt</span><span class="o">$</span><span class="n">label</span><span class="o">==</span><span class="s2">"N"</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="o">-</span><span class="n">dt</span><span class="o">$</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">dt</span><span class="o">$</span><span class="n">p</span><span class="p">)</span><span class="w">
</span><span class="n">prob_knn</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dt</span><span class="o">$</span><span class="n">reverse</span><span class="w">
</span><span class="n">print</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">ifelse</span><span class="p">(</span><span class="n">dt</span><span class="o">$</span><span class="n">reverse</span><span class="o">&gt;</span><span class="m">0.5</span><span class="p">,</span><span class="s2">"Y"</span><span class="p">,</span><span class="s2">"N"</span><span class="p">)</span><span class="o">==</span><span class="n">test_y</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] 0.7608696
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">print</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">labe</span><span class="o">==</span><span class="n">test_y</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] 0.7608696
</code></pre></div></div>

<h2 id="plot-the-roc-curve">Plot the ROC curve</h2>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">pROC</span><span class="p">)</span><span class="w">
</span><span class="n">logit_roc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">roc</span><span class="p">(</span><span class="n">test_y</span><span class="p">,</span><span class="w"> </span><span class="n">test_prediction_prob</span><span class="p">)</span><span class="w">
</span><span class="n">lda_roc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">roc</span><span class="p">(</span><span class="n">test_y</span><span class="p">,</span><span class="w"> </span><span class="n">lda_prediction</span><span class="o">$</span><span class="n">posterior</span><span class="p">[,</span><span class="m">2</span><span class="p">])</span><span class="w">
</span><span class="n">qda_roc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">roc</span><span class="p">(</span><span class="n">test_y</span><span class="p">,</span><span class="w"> </span><span class="n">qda_prediction</span><span class="o">$</span><span class="n">posterior</span><span class="p">[,</span><span class="m">2</span><span class="p">])</span><span class="w">
</span><span class="n">NBa_roc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">roc</span><span class="p">(</span><span class="n">test_y</span><span class="p">,</span><span class="w"> </span><span class="n">NB_prediction_for_ROC</span><span class="p">[,</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">knn_roc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">roc</span><span class="p">(</span><span class="n">test_y</span><span class="p">,</span><span class="n">prob_knn</span><span class="p">)</span><span class="w">
</span><span class="n">roc_list</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">LOGIT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">logit_roc</span><span class="p">,</span><span class="w">
                 </span><span class="n">LDA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lda_roc</span><span class="p">,</span><span class="w">
                 </span><span class="n">QDA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">qda_roc</span><span class="p">,</span><span class="w">
                 </span><span class="n">NB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NBa_roc</span><span class="p">,</span><span class="w">
                 </span><span class="n">KNN</span><span class="o">=</span><span class="n">knn_roc</span><span class="p">)</span><span class="w">

</span><span class="n">ggroc</span><span class="p">(</span><span class="n">roc_list</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">1.2</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">"ROC curves of the models"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"top"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">colour</span><span class="o">=</span><span class="s2">""</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_abline</span><span class="p">(</span><span class="n">intercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">slope</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="m">0.3</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/classification-models/README-unnamed-chunk-48-1.png" alt="" /><!-- --></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"LOGIT AUC:"</span><span class="p">,</span><span class="n">auc</span><span class="p">(</span><span class="n">logit_roc</span><span class="p">)))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "LOGIT AUC: 0.724484399788472"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"LDA AUC:"</span><span class="p">,</span><span class="n">auc</span><span class="p">(</span><span class="n">lda_roc</span><span class="p">)))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "LDA AUC: 0.747223691168694"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"QDA AUC:"</span><span class="p">,</span><span class="n">auc</span><span class="p">(</span><span class="n">qda_roc</span><span class="p">)))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "QDA AUC: 0.757800105764146"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"NB AUC:"</span><span class="p">,</span><span class="n">auc</span><span class="p">(</span><span class="n">NBa_roc</span><span class="p">)))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "NB AUC: 0.777366472765732"
</code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">print</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"KNN AUC:"</span><span class="p">,</span><span class="n">auc</span><span class="p">(</span><span class="n">knn_roc</span><span class="p">)))</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] "KNN AUC: 0.768376520359598"
</code></pre></div></div>

<p>There is no method that clearly overperforms others. We can notice that
the accuracy of the Knn was higher than the NaiveBayes while the area
under the curve smaller so maybe there could be a problem with NB.</p>

<blockquote>
  <h1 id="exercise-6">Exercise 6</h1>
</blockquote>

<blockquote>
  <p>Since the predictors are continuous, there could be also the option of
including polynomial terms. In the context of logistic regression -
Consider only the predictor C2 and fit a model which includes higher
orders of this variable in the model; - Explore different degrees and
check the performance on test data to reach a conclusion on the
optimal degree; - Write the formula of your optimal model.</p>
</blockquote>

<h2 id="polynomial-regression">Polynomial regression</h2>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span><span class="w">
</span><span class="n">random_number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sample</span><span class="p">(</span><span class="m">392</span><span class="p">,</span><span class="m">92</span><span class="p">)</span><span class="w">
</span><span class="n">training_x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="o">-</span><span class="n">random_number</span><span class="p">,]</span><span class="w">
</span><span class="n">training_y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="o">-</span><span class="n">random_number</span><span class="p">,</span><span class="s2">"disease"</span><span class="p">]</span><span class="w">
</span><span class="n">test_x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="n">random_number</span><span class="p">,]</span><span class="w">
</span><span class="n">test_y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="p">[</span><span class="n">random_number</span><span class="p">,</span><span class="w"> </span><span class="s2">"disease"</span><span class="p">]</span><span class="w">
</span><span class="n">accuracy_train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">()</span><span class="w">
</span><span class="n">accuracy_test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">()</span><span class="w">
</span><span class="n">tp_</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">()</span><span class="w">
</span><span class="n">tn_</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">()</span><span class="w">

</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">15</span><span class="p">){</span><span class="w">
 </span><span class="n">poly_logit</span><span class="o">&lt;-</span><span class="w"> </span><span class="n">glm</span><span class="p">(</span><span class="n">disease</span><span class="o">~</span><span class="n">poly</span><span class="p">(</span><span class="n">C2</span><span class="p">,</span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">training_x</span><span class="p">,</span><span class="w"> </span><span class="n">family</span><span class="o">=</span><span class="n">binomial</span><span class="p">)</span><span class="w">
 </span><span class="n">pred_train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">poly_logit</span><span class="p">,</span><span class="w"> </span><span class="n">training_x</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"response"</span><span class="p">)</span><span class="w"> 
 </span><span class="n">pred_test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">poly_logit</span><span class="p">,</span><span class="w"> </span><span class="n">test_x</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"response"</span><span class="p">)</span><span class="w"> 
 </span><span class="n">lab_train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ifelse</span><span class="p">(</span><span class="n">pred_train</span><span class="o">&gt;</span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="s2">"Y"</span><span class="p">,</span><span class="s2">"N"</span><span class="p">)</span><span class="w">
 </span><span class="n">lab_test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ifelse</span><span class="p">(</span><span class="n">pred_test</span><span class="o">&gt;</span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="s2">"Y"</span><span class="p">,</span><span class="s2">"N"</span><span class="p">)</span><span class="w">
 </span><span class="n">accuracy_train</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_train</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">lab_train</span><span class="o">==</span><span class="n">training_y</span><span class="p">))</span><span class="w">
 </span><span class="n">accuracy_test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">append</span><span class="p">(</span><span class="n">accuracy_test</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">lab_test</span><span class="o">==</span><span class="n">test_y</span><span class="p">))</span><span class="w">
 </span><span class="n">tp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">table</span><span class="p">(</span><span class="n">lab_test</span><span class="p">,</span><span class="w"> </span><span class="n">test_y</span><span class="p">)[</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">]</span><span class="o">/</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">lab_test</span><span class="p">,</span><span class="w"> </span><span class="n">test_y</span><span class="p">)[,</span><span class="m">2</span><span class="p">])</span><span class="w">
 </span><span class="n">tn</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">table</span><span class="p">(</span><span class="n">lab_test</span><span class="p">,</span><span class="w"> </span><span class="n">test_y</span><span class="p">)[</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">]</span><span class="o">/</span><span class="nf">sum</span><span class="p">(</span><span class="n">table</span><span class="p">(</span><span class="n">lab_test</span><span class="p">,</span><span class="w"> </span><span class="n">test_y</span><span class="p">)[,</span><span class="m">1</span><span class="p">])</span><span class="w">
 </span><span class="n">tp_</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">append</span><span class="p">(</span><span class="n">tp_</span><span class="p">,</span><span class="w"> </span><span class="n">tp</span><span class="p">)</span><span class="w">
 </span><span class="n">tn_</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">append</span><span class="p">(</span><span class="n">tn_</span><span class="p">,</span><span class="w"> </span><span class="n">tn</span><span class="p">)}</span><span class="w">
</span></code></pre></div></div>

<h2 id="plot-of-the-results">Plot of the results</h2>

<p>Let’s plot these results and see what happen trough different degrees of
the polynomial regression:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">degreeDF</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">ac_train</span><span class="o">=</span><span class="n">accuracy_train</span><span class="p">,</span><span class="w"> </span><span class="n">ac_test</span><span class="o">=</span><span class="n">accuracy_test</span><span class="p">,</span><span class="w"> </span><span class="n">tp</span><span class="o">=</span><span class="n">tp_</span><span class="p">,</span><span class="w"> </span><span class="n">tn</span><span class="o">=</span><span class="n">tn_</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">accuracy_train</span><span class="p">))</span><span class="w">
</span><span class="n">plot1</span><span class="w"> </span><span class="o">&lt;-</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">degreeDF</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">n</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">ac_train</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="o">=</span><span class="s2">"Train accuracy"</span><span class="p">),</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">1.3</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">ac_test</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="o">=</span><span class="s2">"Test accuracy"</span><span class="p">),</span><span class="n">lwd</span><span class="o">=</span><span class="m">1.3</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">n</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">ac_test</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="o">=</span><span class="s2">"Test accuracy"</span><span class="p">),</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">3</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">ac_train</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="o">=</span><span class="s2">"Train accuracy"</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="m">3</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Train and test accuracy ~ Degree of the polynomial"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">xlab</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">"Degree of the polynomial"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">ylab</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">"Train and test accuracy"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">scale_color_manual</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">values</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"royalblue"</span><span class="p">,</span><span class="s2">"salmon"</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"top"</span><span class="p">)</span><span class="w">

</span><span class="n">plot2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">degreeDF</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">n</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">tp</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="o">=</span><span class="s2">"True positive rate"</span><span class="p">),</span><span class="n">lwd</span><span class="o">=</span><span class="m">1.3</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">tn</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="o">=</span><span class="s2">"True negative rate"</span><span class="p">),</span><span class="n">lwd</span><span class="o">=</span><span class="m">1.3</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">n</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">tn</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="o">=</span><span class="s2">"True negative rate"</span><span class="p">),</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">3</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">tp</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="o">=</span><span class="s2">"True positive rate"</span><span class="p">),</span><span class="n">size</span><span class="o">=</span><span class="m">3</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"True positive and true negative rate ~ Degree of the polynomial"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">xlab</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">"Degree of the polynomial"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">ylab</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">"True positive and true negative rate"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">scale_color_manual</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">values</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"gold1"</span><span class="p">,</span><span class="s2">"firebrick"</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"top"</span><span class="p">)</span><span class="w">

</span><span class="n">gridExtra</span><span class="o">::</span><span class="n">grid.arrange</span><span class="p">(</span><span class="n">plot1</span><span class="p">,</span><span class="n">plot2</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="/home/assets/images/README_figs/classification-models/README-unnamed-chunk-51-1.png" alt="" /><!-- --></p>

<p>From the two graphs above we can see the true positive rate increase
with the increasing degree of the polynomial but overall it is still
low. After the degree 15? the model performs weird.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">poly_logit</span><span class="o">&lt;-</span><span class="w"> </span><span class="n">glm</span><span class="p">(</span><span class="n">disease</span><span class="o">~</span><span class="n">poly</span><span class="p">(</span><span class="n">C2</span><span class="p">,</span><span class="m">10</span><span class="p">),</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">training_x</span><span class="p">,</span><span class="w"> </span><span class="n">family</span><span class="o">=</span><span class="n">binomial</span><span class="p">)</span><span class="w">
</span><span class="n">pander</span><span class="p">(</span><span class="n">summary</span><span class="p">(</span><span class="n">poly_logit</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<table>
  <thead>
    <tr>
      <th style="text-align: center"> </th>
      <th style="text-align: center">Estimate</th>
      <th style="text-align: center">Std. Error</th>
      <th style="text-align: center">z value</th>
      <th style="text-align: center">Pr(&gt;|z|)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><strong>(Intercept)</strong></td>
      <td style="text-align: center">-9.587</td>
      <td style="text-align: center">16.63</td>
      <td style="text-align: center">-0.5766</td>
      <td style="text-align: center">0.5642</td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>poly(C2, 10)1</strong></td>
      <td style="text-align: center">315.8</td>
      <td style="text-align: center">563.1</td>
      <td style="text-align: center">0.5609</td>
      <td style="text-align: center">0.5749</td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>poly(C2, 10)2</strong></td>
      <td style="text-align: center">-519.6</td>
      <td style="text-align: center">1020</td>
      <td style="text-align: center">-0.5096</td>
      <td style="text-align: center">0.6103</td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>poly(C2, 10)3</strong></td>
      <td style="text-align: center">752.9</td>
      <td style="text-align: center">1510</td>
      <td style="text-align: center">0.4986</td>
      <td style="text-align: center">0.6181</td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>poly(C2, 10)4</strong></td>
      <td style="text-align: center">-792.4</td>
      <td style="text-align: center">1603</td>
      <td style="text-align: center">-0.4943</td>
      <td style="text-align: center">0.6211</td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>poly(C2, 10)5</strong></td>
      <td style="text-align: center">669.8</td>
      <td style="text-align: center">1399</td>
      <td style="text-align: center">0.4788</td>
      <td style="text-align: center">0.6321</td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>poly(C2, 10)6</strong></td>
      <td style="text-align: center">-452.4</td>
      <td style="text-align: center">973.5</td>
      <td style="text-align: center">-0.4647</td>
      <td style="text-align: center">0.6421</td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>poly(C2, 10)7</strong></td>
      <td style="text-align: center">234.8</td>
      <td style="text-align: center">533.5</td>
      <td style="text-align: center">0.4402</td>
      <td style="text-align: center">0.6598</td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>poly(C2, 10)8</strong></td>
      <td style="text-align: center">-99.77</td>
      <td style="text-align: center">248.2</td>
      <td style="text-align: center">-0.402</td>
      <td style="text-align: center">0.6876</td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>poly(C2, 10)9</strong></td>
      <td style="text-align: center">33.59</td>
      <td style="text-align: center">82.83</td>
      <td style="text-align: center">0.4055</td>
      <td style="text-align: center">0.6851</td>
    </tr>
    <tr>
      <td style="text-align: center"><strong>poly(C2, 10)10</strong></td>
      <td style="text-align: center">-3.381</td>
      <td style="text-align: center">20.22</td>
      <td style="text-align: center">-0.1672</td>
      <td style="text-align: center">0.8672</td>
    </tr>
  </tbody>
</table>

<p>(Dispersion parameter for binomial family taken to be 1 )</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center"> </th>
      <th style="text-align: center"> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">Null deviance:</td>
      <td style="text-align: center">380.5 on 299 degrees of freedom</td>
    </tr>
    <tr>
      <td style="text-align: center">Residual deviance:</td>
      <td style="text-align: center">265.8 on 289 degrees of freedom</td>
    </tr>
  </tbody>
</table>

<p>if we take the degree of polynomial 10 the formula is:</p>

<p>\(\hat{p}= \frac{\\exp(-9.586+ (315.8C2)-(519.5C2^{2}) + (752.9\*C2^{3}) - (792.3\*C2^{4}) + (669.7\*C2^{5}) -(452\*C2^{6} )...}{1 + \\exp(-9.586+ (315.8\*C2)-(519.5\*C2^{2}) + (752.9\*C2^{3}) - (792.3\*C2^{4}) + (669.7\*C2^{5}) -(452\*C2^{6} )...}\).</p>

<p>\newline
We’ve stopped writing but the reasoning is the same up to 10.</p>
:ET